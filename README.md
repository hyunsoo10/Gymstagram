# âœ¨FINAL PROJECTâœ¨

### SSAFY 10ê¸° 1í•™ê¸° ìµœì¢… ê´€í†µ í”„ë¡œì íŠ¸

#### ì£¼ì œ: AVTY(ìš´ë™ ì„±í–¥) í…ŒìŠ¤íŠ¸ì™€ ìš´ë™ ë‹¤ì´ì–´ë¦¬ğŸ“’

<br/>

## ğŸ¤²ğŸ» íŒ€ì› êµ¬ì„± ë° ì—­í•  ë¶„ë‹´ ğŸ¤²ğŸ»

<table align="center">
    <tr align="center">
        <td style="min-width: 250px;">
            <a href="https://github.com/hyunsoo10">
              <img src="https://avatars.githubusercontent.com/u/139304756?v=4" width="100">
              <br />
              <b>ì¡°í˜„ìˆ˜(íŒ€ì¥)</b>
            </a> 
        </td>
        <td style="min-width: 250px;">
            <a href="https://github.com/se2develop">
              <img src="https://avatars.githubusercontent.com/u/139305078?v=4" width="100">
              <br />
              <b>ë…¸ì„¸í¬</b>
            </a>
        </td>
    </tr>
    <tr align="left">
        <td>
        0. ğŸ‘¨ğŸ»â€ğŸ’»Back-end / Front-end<br> 
        1. Dto / Dao / Controller / Service êµ¬í˜„ <br>
        2. Diary ë“±ë¡ / ì¡°íšŒ / ìˆ˜ì • / ì‚­ì œ <br>
        3. DB ëª¨ë¸ë§ <br>
        4. ìœ íŠœë¸Œ APIí™œìš© ìŒì•… ì¬ìƒ ê¸°ëŠ¥ <br>
        5. ëŒ€ëŒ“ê¸€ ì‘ì„± ë° ì‚­ì œëœ ëŒ“ê¸€ ê¸°ëŠ¥  <br>
        6. Jwt í† í° ì¸ì¦ ë°©ì‹ ë¡œê·¸ì¸ ë° ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ <br>
        7. ì´ë¯¸ì§€ ì—…ë¡œë“œ with Drag & Drop  <br>
        8. ì‚¬ìš©ì ë¹„í™œì„±í™” / í™œì„±í™” <br>
        9. ê²Œì‹œë¬¼ ì¢‹ì•„ìš” ê¸°ëŠ¥ <br>
        10. ê²Œì‹œë¬¼ ê²€ìƒ‰ ì¡°íšŒ ê¸°ëŠ¥ <br>
        <br/>
        </td>
        <td>
        0. ğŸ‘©ğŸ»â€ğŸ’»Front-end / Back-end<br>
        1. Mapper.xml ì‘ì„± <br>
        2. User ë“±ë¡  / ì¡°íšŒ / ìˆ˜ì • / ì‚­ì œ <br>
        3. DB ëª¨ë¸ë§ <br>
        4. ë‚ ì”¨ API / ì¹´ì¹´ì˜¤ë§µ API í™œìš© ë‚ ì”¨ ì¹´ë“œ <br>
        5. AVTY í…ŒìŠ¤íŠ¸ ì§„í–‰ ë° ê²°ê³¼ í™”ë©´ <br>
        6. V- Calendar í™œìš©í•œ Diary ì¡°íšŒ<br>
        7. ìœ ì € í”„ë¡œí•„ ê¸°ëŠ¥ ë° í™”ë©´ <br>
        8. DB ì˜ˆì‹œ ë°ì´í„° ì‘ì„± <br>
        <br/>
        </td>
    </tr>
</table>

<br/>
<br/>

<div align=left><h2>ğŸ’»TECH STACKS</h2></div>

<div align=center> 
  <img src="https://img.shields.io/badge/vue.js-4FC08D?style=for-the-badge&logo=vue.js&logoColor=white"> 
  <img src="https://img.shields.io/badge/html5-E34F26?style=for-the-badge&logo=html5&logoColor=white"> 
  <img src="https://img.shields.io/badge/css-1572B6?style=for-the-badge&logo=css3&logoColor=white"> 
  <img src="https://img.shields.io/badge/javascript-F7DF1E?style=for-the-badge&logo=javascript&logoColor=black"> 
  <br>
  <img src="https://img.shields.io/badge/java-007396?style=for-the-badge&logo=java logoColor=white"> 
  <img src="https://img.shields.io/badge/spring-6DB33F?style=for-the-badge&logo=spring&logoColor=white"> 
  <img src="https://img.shields.io/badge/mysql-4479A1?style=for-the-badge&logo=mysql&logoColor=white"> 
  <img src="https://img.shields.io/badge/apache tomcat-F8DC75?style=for-the-badge&logo=apachetomcat&logoColor=white">
  <br>


  <img src="https://img.shields.io/badge/vuetify-339AF0?style=for-the-badge&logo=vuetify&logoColor=#1867C0">
  <img src="https://img.shields.io/badge/bootstrap-7952B3?style=for-the-badge&logo=bootstrap&logoColor=white">
  <img src="https://img.shields.io/badge/fontawesome-339AF0?style=for-the-badge&logo=fontawesome&logoColor=white">
  <br>

  <img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white">
  <img src="https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white">
</div>

##  ğŸ¯í”„ë¡œì íŠ¸ ëª©í‘œ

###### ğŸ”† ì›¹ ì•„í‚¤í…ì²˜ë¥¼ ì´í•´í•˜ê³  ì´ë¥¼ í™œìš©í•˜ì—¬ ì›¹ í”„ë¡œì íŠ¸ë¥¼ ì„¤ê³„í•˜ê³  êµ¬í˜„í•  ìˆ˜ ìˆë‹¤.
###### ğŸ”† SpringBootì™€ Vueë¥¼ ì´í•´í•˜ê³  í™œìš©í•  ìˆ˜ ìˆë‹¤.
###### ğŸ”† Rest APIì™€ Vue Routerë¥¼ í™œìš©í•˜ì—¬ SPA ë°©ì‹ìœ¼ë¡œ í”„ë¡œì íŠ¸ë¥¼ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.
###### ğŸ”† ê¸°ì¡´ ê´€í†µ í”„ë¡œì íŠ¸ì— ìƒˆë¡œìš´ ì•„ì´ë””ì–´ë¥¼ ì¶”ê°€í•˜ì—¬ ê³¼ì •ì—ì„œ ë°°ìš´ ê¸°ìˆ ë“¤ì„ ë‹¤ì–‘í•˜ê²Œ êµ¬í˜„í•´ ë³¸ë‹¤.

<br/>
<br/>

# ì„¤ê³„ì„œ

## ğŸ“Œ ìš”êµ¬ì‚¬í•­

- Spring Bootì™€ MyBatis ì—°ë™ì„ í™œìš©í•œ Rest API ì„œë²„ êµ¬í˜„
- Vue3 ë²„ì „ì„ í™œìš©í•œ SPA í´ë¼ì´ì–¸íŠ¸ êµ¬í˜„

> âœ… : êµ¬í˜„ ì™„ë£Œ  âŒ : ë¯¸êµ¬í˜„

#### 1ï¸âƒ£ ê¸°ë³¸ê¸°ëŠ¥ âœ…

- íšŒì›ê°€ì… / íšŒì›íƒˆí‡´ âœ…
- ë¡œê·¸ì¸ / ë¡œê·¸ì•„ì›ƒ âœ…
- ë‹¤ì´ì–´ë¦¬ ì‘ì„± / ì¡°íšŒ / ìˆ˜ì • / ì‚­ì œ âœ…
- ëŒ“ê¸€ ì‘ì„± / ì¡°íšŒ / ìˆ˜ì • / ì‚­ì œ âœ…
- AVTY í€´ì¦ˆ ì§„í–‰ ë° ê²°ê³¼ ë°˜ì˜ âœ…
- My Diary í˜ì´ì§€ âœ…

#### 2ï¸âƒ£ ì¶”ê°€ê¸°ëŠ¥ âœ…

- Diary ì¢‹ì•„ìš” âœ…
- Weekly Diary ì¡°íšŒ âœ…
- ì´ë¯¸ì§€ ì—…ë¡œë“œ âœ…
- Diary AVTY ê¸°ì¤€ ì¡°íšŒâœ…
- Youtube API ìŒì•… ì¬ìƒ âœ…
- Apex Chartsë¡œ AVTY ë¹„ìœ¨ ì°¨íŠ¸ ë³´ì—¬ì£¼ê¸° âœ…

#### 3ï¸âƒ£ ì‹¬í™”ê¸°ëŠ¥
- ì´ë¯¸ì§€ ì—…ë¡œë“œ Drag & Drop âœ…
- ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ âœ…
- ëŒ€ëŒ“ê¸€ âœ…
- ìœ ì € ê³„ì • í™œì„±í™” / ë¹„í™œì„±í™” âœ…
-  v-calendar ë¡œ diary ì¡°íšŒ âœ…
- ê¸°ìƒì²­ API ì™€ Kakao Map API í™œìš©í•œ ë‚ ì”¨ ì¹´ë“œ âœ…


## ğŸ“Œ ìœ ì¦ˆì¼€ì´ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨

## ğŸ“Œ í…Œì´ë¸” êµ¬ì¡°ë„(ERD)
<img src="README_IMG/ERD.png">

## ğŸ“Œ í´ë˜ìŠ¤ ë‹¤ì´ì–´ê·¸ë¨
<img src="README_IMG/class_diagram.png">

## ğŸ“Œ í™”ë©´ ì„¤ê³„ì„œ (Figma)
<img src="README_IMG/Figma.png">





# ğŸ¬ í”„ë¡œì íŠ¸ OVERVIEW

#### íšŒì›ê°€ì… (íŒŒì¼ Drag & Drop)
<img src="README_IMG/íšŒì›ê°€ì….gif">

#### ë¡œê·¸ì¸ / ë¡œê·¸ì•„ì›ƒ
<img src="README_IMG/í™ˆ_ë¡œê·¸ì¸_ë¡œê·¸ì•„ì›ƒ.gif">

#### ì¹´ì¹´ì˜¤ë¡œê·¸ì¸
<img src="README_IMG/ì¹´ì¹´ì˜¤ë¡œê·¸ì¸.gif">

#### AVTY í…ŒìŠ¤íŠ¸
<img src="README_IMG/AVTYí…ŒìŠ¤íŠ¸.gif">

#### íšŒì› ì •ë³´ ìˆ˜ì •(ë¹„í™œì„±í™”, íƒˆí‡´)
<img src="README_IMG/íšŒì›ì •ë³´ìˆ˜ì •.gif">

#### ë‹¤ì´ì–´ë¦¬ ì‘ì„±
<img src="README_IMG/ë‹¤ì´ì–´ë¦¬ì‘ì„±.gif">

#### ë‹¤ì´ì–´ë¦¬ ì¡°íšŒ
<img src="README_IMG/ë‹¤ì´ì–´ë¦¬ì¡°íšŒ.gif">

#### ë‹¤ì´ì–´ë¦¬ ìˆ˜ì •
<img src="README_IMG/ë‹¤ì´ì–´ë¦¬ìˆ˜ì •.gif">

#### ë‹¤ì´ì–´ë¦¬ ì‚­ì œ
<img src="README_IMG/ë‹¤ì´ì–´ë¦¬ì‚­ì œ.gif">

#### ëŒ“ê¸€ ì‘ì„±, ìˆ˜ì •, ì‚­ì œ
<img src="README_IMG/ëŒ“ê¸€.gif">

#### ë‹µê¸€ ì‘ì„±, ìˆ˜ì •, ì‚­ì œ
<img src="README_IMG/ë‹µê¸€.gif">


<br>
<br>

# ì†ŒìŠ¤ì½”ë“œ ë° DB ìŠ¤í¬ë¦½íŠ¸

## ğŸ“Œ ë°±ì—”ë“œ

ğŸ“‚ **<u>í´ë” êµ¬ì¡°</u>**
```
ğŸ“‚ FINAL_PJT_API
  ã„´ ğŸ“‚ src\main\java
      ã„´ ğŸ“‚ com\ssafy\pjt
          ã„´ ğŸ“„ FinalPjtApiApplication.java
          ã„´ ğŸ“‚ config
              ã„´ ğŸ“„ SwaggerConfig.java
              ã„´ ğŸ“„ WebConfig.java
          ã„´ ğŸ“‚ controller
              ã„´ ğŸ“„ DiaryRestController.java
              ã„´ ğŸ“„ UserRestController.java
          ã„´ ğŸ“‚ interceptor
              ã„´ ğŸ“„ JwtInterceptor.java
          ã„´ ğŸ“‚ model
              ã„´ ğŸ“‚ dao
                  ã„´ ğŸ“„ DiaryDao.java
                  ã„´ ğŸ“„ UserDao.java
              ã„´ ğŸ“‚ dto
                  ã„´ ğŸ“„ Comment.java
                  ã„´ ğŸ“„ Diary.java
                  ã„´ ğŸ“„ LikeDiary.java
                  ã„´ ğŸ“„ SearchCondition.java
                  ã„´ ğŸ“„ User.java
              ã„´ ğŸ“‚ service
                  ã„´ ğŸ“„ DiaryService.java
                  ã„´ ğŸ“„ DiaryServiceImpl.java
                  ã„´ ğŸ“„ UserService.java
                  ã„´ ğŸ“„ UserServiceImpl.java
  ã„´ ğŸ“‚ src\main\resources
      ã„´ ğŸ“‚ mappers
          ã„´ ğŸ“„ diaryMapper.java
          ã„´ ğŸ“„ userMapper.java
      ã„´ ğŸƒ application.properties

```

### DiaryRestController

#### 1 - (1) ì´ë¯¸ì§€ íŒŒì¼ ì—…ë¡œë“œ(MultipartFile Typeìœ¼ë¡œ ë°›ê¸°)
```java
	// diary ì¶”ê°€
	@PostMapping(value = "/diary", consumes = { MediaType.MULTIPART_FORM_DATA_VALUE })
	@ApiOperation(value = "ìƒˆë¡œìš´ diaryì¶”ê°€")
	public ResponseEntity<?> insertOne(
			@RequestPart(required = false) @RequestParam(value = "image", required = false) MultipartFile file,
			@RequestPart("diary") Diary diary) {
		try {
			// ê²°ê³¼ ê°’ ë‹´ì„ ë³€ìˆ˜
			int result = 0;
			if (file != null && file.getSize() > 0) {
				String uploadPath = "C:\\FINAL\\PJT-FINAL-I-CHS-NSH\\ssafy_final_project\\src\\assets\\diary_image\\"
						+ diary.getUserId();
				String saveName = UUID.randomUUID() + "_" + diary.getOriginalImage();
				File target = new File(uploadPath, saveName);

				if (!new File(uploadPath).exists()) {
					new File(uploadPath).mkdirs();
				}

				try {
					FileCopyUtils.copy(file.getBytes(), target);
					diary.setSaveImage(saveName);
					result = diaryService.addDiary(diary);
				} catch (IOException e) {
					e.printStackTrace();
				}
			} else {
				// íŒŒì¼ì´ ì—†ìœ¼ë©´ ê·¸ëƒ¥ ì—…ë¡œë“œ
				result = diaryService.addDiary(diary);
			}
			
			
			if (result > 0) {
				return new ResponseEntity<Diary>(diary, HttpStatus.OK);
			} else
				return new ResponseEntity<Void>(HttpStatus.BAD_REQUEST);
		} catch (Exception e) {
			return exceptionHandling(e);
		}
	}
```
#### 1 - (2) ì´ë¯¸ì§€ íŒŒì¼ ì—…ë¡œë“œ(JSON í˜•ì‹ìœ¼ë¡œ ë°›ê¸°)
```java
	//diary ì¶”ê°€ (ì´ë¯¸ì§€ë¥¼ Base64ë¡œ ì¸ì½”ë”©í•´ì„œ ë³´ë‚¼ ë•Œ)
	@PostMapping(value = "/diary")
	@ApiOperation(value = "ìƒˆë¡œìš´ diaryì¶”ê°€")
	public ResponseEntity<?> insertOne(@RequestBody Diary diary){
		try {

			int result =  diaryService.addDiary(diary);
			if (result > 0) {
				return new ResponseEntity<Diary>(diary, HttpStatus.OK);
			} else
				return new ResponseEntity<Void>(HttpStatus.BAD_REQUEST);
		} catch (Exception e) {
			return exceptionHandling(e);
		}
	}
```
ğŸ’¡ Description <br>

ë‹¤ì´ì–´ë¦¬ì— ì´ë¯¸ì§€ íŒŒì¼ì„ ì—…ë¡œë“œí•´ì„œ íŒŒì¼ì„ ì €ì¥/ê´€ë¦¬ í•˜ëŠ” ë°©ë²•ì— ëŒ€í•œ ê³ ë¯¼ì„ ë§ì´ í–ˆìŠµë‹ˆë‹¤. í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë°±ì—”ë“œë¡œ ë°ì´í„°ë¥¼ ë„˜ê²¨ì¤„ ë•Œ ì£¼ë¡œ JSON í˜•íƒœë¡œ ë„˜ê²¨ì£¼ê³  ë°±ì—”ë“œì—ì„œëŠ” ì´ ë°ì´í„°ë¥¼ @RequestBodyë¥¼ ì´ìš©í•´ì„œ ì ì ˆí•œ ê°ì²´ë¡œ ë°ì´í„°ë¥¼ ë°›ì•„ì˜¤ëŠ” ë°©ì‹ì´ ì¼ë°˜ì ì…ë‹ˆë‹¤. í•˜ì§€ë§Œ, ë°ì´í„°ì— ì´ë¯¸ì§€ê°€ í¬í•¨ë˜ì–´ ìˆìœ¼ë©´ ì¼ë°˜ì ì¸ ë°©ë²•ìœ¼ë¡œ ì „ë‹¬ì´ ë¶ˆê°€ëŠ¥í•©ë‹ˆë‹¤. ë”°ë¼ì„œ ì €í¬ëŠ” 2ê°€ì§€ ë°©ë²•ì„ ê³ ë¯¼í–ˆìŠµë‹ˆë‹¤. <br>

#### 1ï¸âƒ£ JSON ë°ì´í„°ë¥¼ íŒŒì¼ í˜•ì‹ìœ¼ë¡œ ì „í™˜í•´ì„œ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ëŠ”ë‹¤.

    í”„ë¡ íŠ¸ì—”ë“œìª½ì—ì„œ var formData = new FormData() ê°ì²´ë¥¼ í™œìš©í•´ì„œ ì´ë¯¸ì§€íŒŒì¼ì„ ë‹´ê³ ,
    í•„ìš”í•œ JSON ë°ì´í„°ë„ BLOBí˜•íƒœë¡œ ë³€í™˜í•´ì„œ ë‹´ì•„ì¤€ í›„ì—, ì´ë¥¼ ë°±ì—”ë“œ ìª½ì— ë³´ë‚´ë©´, 
    @RequestParam typeìœ¼ë¡œ ê°’ì„ ë°›ì•„ì„œ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë•Œ ë°›ì€ ì´ë¯¸ì§€ íŒŒì¼ì€ 
    ì§€ì •í•œ ê²½ë¡œì— ì €ì¥í•´ì£¼ê³ , ì´ë•Œ ì €ì¥í•œ ì´ë¦„ì„ DBì— ì €ì¥í•œë‹¤ë©´ í”„ë¡ íŠ¸ ì—”ë“œ ìª½ì—ì„œ
    ì´ ê²½ë¡œë¥¼ í†µí•´ ì´ë¯¸ì§€ íŒŒì¼ì— ì ‘ê·¼í•´ì„œ ì ì ˆí•œ íŒŒì¼ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
  


#### 2ï¸âƒ£ íŒŒì¼ ë°ì´í„°ë¥¼ JSON í˜•ì‹ìœ¼ë¡œ ì „í™˜í•´ì„œ ë°ì´í„°ë¥¼ ì£¼ê³  ë°›ëŠ”ë‹¤.

    í”„ë¡ íŠ¸ì—”ë“œ ìª½ì—ì„œ ì´ë¯¸ì§€ íŒŒì¼ì„ Base64ë¡œ ì¸ì½”ë”© í•˜ë©´ ë¬¸ìì—´ë¡œ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    ì´ ë¬¸ìì—´ì„ JSONì— ë‹´ì•„ì„œ ë°±ì—”ë“œë¡œ ë³´ë‚´ë©´, @RequestBodyë¡œ JSON ë°ì´í„°ë¥¼ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    ê·¸ë¦¬ê³  ì´ ë¬¸ìì—´ì„ DBì— ê·¸ëŒ€ë¡œ ì €ì¥í•´ì„œ(LONGTEXT) ë‚˜ì¤‘ì— ì´ ë¬¸ìì—´ì„ í”„ë¡ íŠ¸ì—”ë“œì˜
    src ê²½ë¡œì— ë¶ˆëŸ¬ì˜¤ë©´ ì´ë¯¸ì§€ íŒŒì¼ì„ í™”ë©´ì— ë³´ì—¬ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    ì´ ë°©ì‹ì€ íŒŒì¼ì„ ìƒì„±í•´ì„œ ì—…ë¡œë“œ í•˜ëŠ” ë°©ì‹ì´ ì•„ë‹ˆê³ , ì´ë¯¸ì§€ë¥¼ Base64 ì¸ì½”ë”©ìœ¼ë¡œ ë¬¸ìì—´ì„ ë§Œë“¤ê³ 
    ë‚˜ì¤‘ì— í™”ë©´ì— í•´ë‹¹ ì´ë¯¸ì§€ë¥¼ ë‹¤ì‹œ ë””ì½”ë”©í•´ì„œ ë³´ì—¬ì£¼ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.
    ë§Œì•½ì— ìš°ë¦¬ê°€ ì´ë¯¸ì§€ë¥¼ ë”°ë¡œ ì €ì¥í•  í•„ìš” ì—†ê³ , í•œ ë°ì´í„°ì— í•œ ê°€ì§€ ì´ë¯¸ì§€ë§Œ ì¡´ì¬í•˜ë©°
    ê·¸ ì´ë¯¸ì§€ê°€ ìì£¼ ë°”ë€ŒëŠ” ë“±ì˜ í–‰ìœ„ê°€ ì¼ì–´ë‚œë‹¤ë©´ ì´ ë°©ì‹ì„ í†µí•´ ì´ë¯¸ì§€ë¥¼ ì €ì¥í•˜ê³  í™œìš©í•˜ëŠ” ë°©ë²•ë„ ìœ ìš©í•  ê²ƒ ê°™ìŠµë‹ˆë‹¤.
<hr>
<br>

### 2. Diary ì¢‹ì•„ìš” / ì¢‹ì•„ìš” í•´ì œ

```java
	// diary ì¢‹ì•„ìš”
	@PostMapping("diary/like")
	@ApiOperation(value = "diary ì¢‹ì•„ìš”")
	public ResponseEntity<?> likeDiary(@RequestBody LikeDiary likeDiary) {
		try {
			int result = diaryService.like(likeDiary);
			int result1 = diaryService.increaseLikeCount(likeDiary.getDiaryId());
			if (result > 0 && result1 > 0) {
				System.out.println(likeDiary.getDiaryId());
				return new ResponseEntity<String>("ì¢‹ì•„ìš” ì„±ê³µ", HttpStatus.OK);
			} else
				return new ResponseEntity<Void>(HttpStatus.BAD_REQUEST);
		} catch (Exception e) {
			return exceptionHandling(e);
		}

	}

	// diary ì¢‹ì•„ìš” í•´ì œ
	@DeleteMapping("diary/like")
	@ApiOperation(value = "diary ì¢‹ì•„ìš” í•´ì œ")
	public ResponseEntity<?> unLikeDiary(@RequestBody LikeDiary likeDiary) {
		try {
			int result = diaryService.unLike(likeDiary);
			int result1 = diaryService.decreaseLikeCount(likeDiary.getDiaryId());
			if (result > 0 && result1 > 0) {
				return new ResponseEntity<String>("ì¢‹ì•„ìš” í•´ì œ", HttpStatus.OK);
			} else
				return new ResponseEntity<Void>(HttpStatus.NO_CONTENT);
		} catch (Exception e) {
			return exceptionHandling(e);
		}

	}
```

ğŸ’¡ Description <br>

ë‹¤ì´ì–´ë¦¬ ì¢‹ì•„ìš” ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ likeDiary í…Œì´ë¸”ì— userIdì™€ diaryIdë¥¼ ë§¤í•‘ ì‹œí‚¨ likeDiary Dtoë¥¼ ë„˜ê²¨ì¤ë‹ˆë‹¤. ê·¸ë¦¬ê³  ë™ì‹œì— í•´ë‹¹ diaryIdì˜ ì¢‹ì•„ìš” ìˆ«ìë¥¼ ì¦ê°€ì‹œì¼œì¤ë‹ˆë‹¤.

ë‹¤ì´ì–´ë¦¬ ì¢‹ì•„ìš” í•´ì œ ìš”ì²­ì´ ë“¤ì–´ì˜¤ë©´ likeDiary Dtoë¥¼ ë„˜ê²¨ì¤˜ì„œ í•´ë‹¹í•˜ëŠ” ê°’ì„ likeDiaryì—ì„œ ì‚­ì œí•´ì¤ë‹ˆë‹¤. ê·¸ë¦¬ê³  ë™ì‹œì— í•´ë‹¹ diaryIdì˜ ì¢‹ì•„ìš” ìˆ«ìë¥¼ ê°ì†Œì‹œì¼œì¤ë‹ˆë‹¤.
<hr>
<br>

### 3. Userì˜ Diary ì¢‹ì•„ìš” ì—¬ë¶€ ì²´í¬ 
``` java

	// diaryIdì™€ userId ë¡œ ë‹¤ì´ì–´ë¦¬ ì¢‹ì•„ìš” ì—¬ë¶€ ì²´í¬
	@GetMapping("diary/like/{userId}/{diaryId}")
	@ApiOperation(value = "diaryì¢‹ì•„ìš” ì—¬ë¶€ í™•ì¸ diaryIdì™€ userIdì™€ ì¼ì¹˜í•˜ëŠ” ëª©ë¡ ìˆëŠ”ì§€ ì²´í¬")
	public ResponseEntity<?> likeList(@PathVariable(value = "userId") String userId,
			@PathVariable(value = "diaryId") int diaryId) {
		try {
			LikeDiary likeDiary = new LikeDiary();

			likeDiary.setUserId(userId);
			likeDiary.setDiaryId(diaryId);
			int result = diaryService.getLikeDiary(likeDiary);
			if (result == 1) {
				return new ResponseEntity<Integer>(1, HttpStatus.OK);
			} else
				return new ResponseEntity<Void>(HttpStatus.NO_CONTENT);
		} catch (Exception e) {
			return exceptionHandling(e);
		}

	}

```
ğŸ’¡ Description <br>
Userê°€ íŠ¹ì • Diaryì— ì¢‹ì•„ìš”ë¥¼ ëˆŒë €ëŠ”ì§€ ì•Šì•˜ëŠ”ì§€ë¥¼ í™•ì¸í•´ì„œ ì‘ë‹µì„ í•´ì£¼ëŠ” API ë©”ì„œë“œì…ë‹ˆë‹¤. íŒŒë¼ë¯¸í„°ë¡œ userId ì™€ diaryIdë¥¼ ì „ë‹¬ ë°›ê³ , DBì˜ likeDiary í…Œì´ë¸”ì—ì„œ ë‘ ê°’ê³¼ ì¼ì¹˜í•˜ëŠ” ê°’ì´ ìˆìœ¼ë©´ í•´ë‹¹ userëŠ” í•´ë‹¹ diaryë¥¼ ì´ë¯¸ ì¢‹ì•„ìš” ëˆ„ë¥¸ ìƒíƒœì´ê³ , ì¼ì¹˜í•˜ëŠ” ê°’ì´ ì—†ìœ¼ë©´ ì•„ì§ ëˆ„ë¥´ì§€ ì•Šì€ ìƒíƒœì…ë‹ˆë‹¤.
<hr>
<br>

### 4. ëŒ“ê¸€ ë¹„í™œì„±í™”

```java
	// ëŒ“ê¸€ ë¹„í™œì„±í™”
	@PutMapping("/diary/uncomment/{commentId}")
	@ApiOperation(value = "{commentId} ëŒ“ê¸€ ë¹„í™œì„±í™”")
	public ResponseEntity<String> unComment(@PathVariable int commentId) {
		try {
			int result = diaryService.unComment(commentId);
			if(result > 0) {
				return new ResponseEntity<String>("ëŒ“ê¸€ì´ ë¹„í™œì„±í™” ëìŠµë‹ˆë‹¤.", HttpStatus.OK);
			}
			return new ResponseEntity<String>("ëŒ“ê¸€ ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.", HttpStatus.NOT_MODIFIED);
		} catch (Exception e) {
			return exceptionHandling(e);
		}
	}
```
ğŸ’¡ Description <br>
íŠ¹ì • ëŒ“ê¸€ì— í•˜ìœ„ ëŒ“ê¸€ì´ ì—…ì„ ê²½ìš° DBì—ì„œ ê·¸ëƒ¥ ì‚­ì œë¥¼ í•˜ê²Œ ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ, í•˜ìœ„ ëŒ“ê¸€ì´ ìˆì„ ê²½ìš°ì— í•´ë‹¹ ëŒ“ê¸€ì„ DBì—ì„œ ì§€ìš°ì§€ ì•Šê³ , isDeleted ì»¬ëŸ¼ì— ê°’ì„ trueë¡œ ë³€ê²½ì‹œì¼œì„œ ë¹„í™œì„±í™” ì‹œí‚µë‹ˆë‹¤. ì´ëŠ” í•´ë‹¹ ëŒ“ê¸€ì´ ì‚­ì œ ë˜ë©´ ê·¸ ëŒ“ê¸€ì— ë‹¬ë¦° ë‹¤ë¥¸ í•˜ìœ„ ëŒ“ê¸€ë“¤ë„ ì‚¬ë¼ì§€ê²Œ ë˜ëŠ” ë¬¸ì œë¥¼ ë°©ì§€í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤. isDeletedê°€ trueì¸ ê²½ìš° í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë‚´ìš©ì„ ë³´ì—¬ì£¼ì§€ ì•Šê³ , "ì‚­ì œëœ ëŒ“ê¸€ì…ë‹ˆë‹¤" ë¼ëŠ” ë¬¸êµ¬ë¥¼ ëŒ€ì‹  ë³´ì—¬ì¤ë‹ˆë‹¤.

<hr>
<br>


### UserRestController

#### 1 Jwt ë¡œê·¸ì¸

```java
	@PostMapping("/user/jwtlogin")
	@ApiOperation(value = "ë¡œê·¸ì¸ with Jwt í† í°ì¸ì¦")
	public ResponseEntity<Map<String, Object>> login(@RequestBody User user) {
		Map<String, Object> result = new HashMap<String, Object>();
		System.out.println("ë°±ì•¤ë“œë¡œ ë„˜ì–´ì˜¤ëŠ” ìœ ì € ì •ë³´ : " + user);
		HttpStatus status = null;
		try {
			//ë¡œê·¸ì¸ ì‹œë„ user ê°ì²´ì˜ IDì™€ ë¹„ë°€ë²ˆí˜¸ì— í•´ë‹¹í•˜ëŠ” userì •ë³´ê°€ ìˆëŠ”ì§€ DBì—ì„œ ê²€ì‚¬
			String userId = user.getUserId();
			String password = user.getUserPassword();

			User dbUser = userService.getOneUser(userId);
			
			
			//ì•„ì´ë””ê°€ ìˆë‹¤ë©´
			if(dbUser != null) {
				//ë¹„ë°€ë²ˆí˜¸ê¹Œì§€ ì¼ì¹˜í•œë‹¤ë©´
				if (dbUser.getUserPassword().equals(password)) {
					//ë‚˜ë¨¸ì§€ í•„ìš”í•œ ì •ë³´ ë‹´ì•„ì£¼ê¸°
					user.setAvtyCode(dbUser.getAvtyCode());
					user.setNickName(dbUser.getNickName());
					user.setProfileImage(dbUser.getProfileImage());
					user.setRegisterDate(dbUser.getRegisterDate());
					user.setUserName(dbUser.getUserName());
					user.setActivate(dbUser.isActivate());
					user.setEmail(user.getEmail());
					//ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì— ìœ ì €ì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì €ì¥í•˜ê³  ì‹¶ì§€ ì•Šì„ ë•Œ ì„ì˜ë¡œ setí•´ì„œ í”„ë¡ íŠ¸ìª½ì— ë³´ë‚¼ ìˆ˜ ìˆë‹¤
					//user.setUserPassword("TOP-SECRET");
					user.setUserPassword(dbUser.getUserPassword());
					System.out.println("í”„ë¡ íŠ¸ë¡œ ë„˜ê¸¸ ìœ ì € ì •ë³´ : " +user);
					
					result.put("access-token", jwtUtil.createToken("user", user));
					
					result.put("message", SUCCESS);
					status = HttpStatus.ACCEPTED;
				}else {
					//ì•„ì´ë””ëŠ” ë§ì•˜ì§€ë§Œ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ë‹¤ë©´
					result.put("message", WRONGPASSWORD);
					status = HttpStatus.OK;
				}
			}
			else {
				//í•´ë‹¹í•˜ëŠ” IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ë‹¤ë©´
				result.put("message", NOFOUNDID);
				status = HttpStatus.OK;
			}
		} catch (UnsupportedEncodingException e) {
			result.put("message", FAIL);
			status = HttpStatus.INTERNAL_SERVER_ERROR;
		}
		
		return new ResponseEntity<Map<String,Object>>(result, status);
	}
```
ğŸ’¡ Description <br>
Jwt í† í° ì¸ì¦ ë°©ì‹ìœ¼ë¡œ accessí† í°ì„ ë°œê¸‰ë°›ê³ , í”„ë¡ íŠ¸ ì—”ë“œì— í•´ë‹¹ í† í° ì •ë³´ë¥¼ ë„˜ê²¨ì¤˜ì„œ ë¡œê·¸ì¸ì„ ì§„í–‰í•˜ëŠ” API ë©”ì„œë“œ ì…ë‹ˆë‹¤. í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ë„˜ê²¨ ë°›ì€ userIdì™€ userPassword ë°ì´í„°ì™€ ì¼ì¹˜í•˜ëŠ” ìœ ì €ê°€ ìˆì„ ê²½ìš° access-tokenê³¼ í•¨ê»˜ user ì •ë³´ë¥¼ í”„ë¡ íŠ¸ì—”ë“œì— ë„˜ê²¨ì¤ë‹ˆë‹¤.

ì²˜ìŒì—ëŠ” userPassword ë°ì´í„°ë¥¼ "TOP-SECRET" ìœ¼ë¡œ ìˆ¨ê²¨ì„œ í”„ë¡ íŠ¸ì—”ë“œë¡œ ë³´ë‚´ì£¼ì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, íšŒì› íƒˆí‡´ / ê³„ì • ë¹„í™œì„±í™” ì‘ì—…ì‹œì— í”„ë¡ íŠ¸ì—”ë“œì—ì„œ userPasswordê°€ í•„ìš”í•œ ìƒí™©ì´ ìƒê²¨ì„œ userPassword ë°ì´í„°ë„ ê°™ì´ ë„˜ê²¨ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ ë°”ê¿¨ìŠµë‹ˆë‹¤. ë¬¼ë¡ , íšŒì› íƒˆí‡´ / ê³„ì • ë¹„í™œì„±í™” ì‘ì—…ì‹œì—ë„ axios ìš”ì²­ì„ ë³´ë‚´ì„œ valid ì—¬ë¶€ë¥¼ í™•ì¸í•´ë„ ê°€ëŠ¥í•˜ì§€ë§Œ, ìš”ì²­ ì—†ì´ ì¦‰ê°ì ìœ¼ë¡œ í™•ì¸í•˜ê¸° ìœ„í•´ì„œ í”„ë¡ íŠ¸ì—”ë“œ ë¶€ë¶„ì—ì„œ password valid ì—¬ë¶€ë¥¼ í™•ì¸ í• ìˆ˜ ìˆë„ë¡ ì‘ì—…í–ˆìŠµë‹ˆë‹¤.

<hr>
<br>

#### 2 User avty ì½”ë“œ ìˆ˜ì •

```java
	@PutMapping(value = "/user/{userId}")
	@ApiOperation(value = "avtyì½”ë“œ ìˆ˜ì •", response = Integer.class) 
	public ResponseEntity<?> updateAvty(@RequestBody User user) {
		int result = userService.modifyAvty(user);
		
		if (result > 0) {
			return new ResponseEntity<User>(user, HttpStatus.OK);
		} else
			return new ResponseEntity<Void>(HttpStatus.BAD_REQUEST);
	}
```

ğŸ’¡ Description <br>
Userì˜ avty í…ŒìŠ¤íŠ¸ê°€ ëë‚˜ë©´, í•´ë‹¹ ê²°ê³¼ë¥¼ í”„ë¡ íŠ¸ì—ì„œ ë°›ì•„ì˜¨ ë‹¤ìŒì— DBì— ê²°ê³¼ ê°’ìœ¼ë¡œ ë‚˜ì˜¨ avty ì½”ë“œë¥¼ ì‚½ì…í•´ì£¼ëŠ” API ë©”ì„œë“œ ì…ë‹ˆë‹¤. userì˜ ì „ì²´ ì •ë³´ ìˆ˜ì • API ë©”ì„œë“œê°€ ìˆê¸´ í•˜ì§€ë§Œ, avty ì»¬ëŸ¼ ì •ë³´ë§Œ ì—…ë°ì´íŠ¸ í•´ì£¼ëŠ” ì‘ì—…ì— user ì „ì²´ ì •ë³´ ìˆ˜ì • API ë©”ì„œë“œë¥¼ í™œìš©í•˜ëŠ” ê²ƒì´ ë¹„íš¨ìœ¨ì ì´ë¼ê³  ìƒê°í–ˆê¸° ë•Œë¬¸ì— ë”°ë¡œ ë©”ì„œë“œë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

<hr>
<br>

#### 3 User ê³„ì • í™œì„±í™” / ë¹„í™œì„±í™”

```java
	// íšŒì› ë¹„í™œì„±í™” / í™œì„±í™”
	@PutMapping("/user/activate/{userId}")
	@ApiOperation(value = "{userId} íšŒì› í™œì„±í™” ìƒíƒœ ë³€í™”")
	public ResponseEntity<String> changeActivate(@PathVariable String userId) {
		try {
			int result = userService.updateUserAct(userId);
			if(result > 0) {
				User user = (User) userService.getOneUser(userId);
				if(user.isActivate())
					return new ResponseEntity<String>("ê³„ì •ì´ í™œì„±í™” ë˜ì—ˆìŠµë‹ˆë‹¤.", HttpStatus.OK);
				else
					return new ResponseEntity<String>("ê³„ì •ì´ ë¹„í™œì„±í™” ë˜ì—ˆìŠµë‹ˆë‹¤.", HttpStatus.OK);
				
			}
			return new ResponseEntity<String>("ê³„ì • ìƒíƒœ ë³€ê²½ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.", HttpStatus.NOT_MODIFIED);
		} catch (Exception e) {
			return exceptionHandling(e);
		}
	}
```
ğŸ’¡ Description <br>
íšŒì› íƒˆí‡´ê°€ ê³ ë¯¼ëœë‹¤ë©´ ê³„ì •ì„ ë¹„í™œì„±í™” ì‹œí‚¬ ìˆ˜ ìˆëŠ” ì˜µì…˜ì„ ì œê³µí•´ì£¼ëŠ”ë°, ì´ë•Œ íšŒì› ê³„ì •ì„ ë¹„í™œì„±í™” ì‹œí‚¤ê³  ë‹¤ì‹œ í™œì„±í™” ì‹œí‚¬ë•Œ í™œìš©í•˜ëŠ” API ë©”ì„œë“œì…ë‹ˆë‹¤. user í…Œì´ë¸”ì˜ activate ì»¬ëŸ¼ì´ trueì´ë©´ í™œì„±í™” ê³„ì •, falseì´ë©´ ë¹„í™œì„±í™” ê³„ì •ì…ë‹ˆë‹¤.

íŒŒë¼ë¯¸í„°ë¡œ ì „ë‹¬ë°›ì€ userIdì— í•´ë‹¹í•˜ëŠ” userì˜ activate ì»¬ëŸ¼ì„ ë°˜ëŒ€ ê°’( activate = !activate)ìœ¼ë¡œ ì „í™˜ì‹œì¼œì£¼ëŠ” ë¡œì§ì„ í†µí•´, í™œì„±í™”ì™€ ë¹„í™œì„±í™” ì‘ì—…ì„ ë™ì¼í•œ ë©”ì„œë“œì—ì„œ ì§„í–‰í•  ìˆ˜ ìˆë„ë¡ í–ˆìŠµë‹ˆë‹¤.

<hr>
<br>

### Mapper

#### 1. diaryMapper.xml

**ë‹¤ì´ì–´ë¦¬ ì¡°íšŒ**
```xml
	<!-- ì „ì²´ ë‹¤ì´ì–´ë¦¬ ì¡°íšŒ -->
	<select id="selectAllDiary" parameterType="SearchCondition" resultType="Diary">
		SELECT diary.diary_id AS diaryId, diary.user_id as userId, diary.title AS title, diary.content AS content, diary.range AS `range`, create_date AS createDate, original_image AS originalImage,
			   save_image AS saveImage, view_count AS viewCount, like_count AS likeCount, avty.avty_name AS avty
		 FROM diary
			INNER JOIN user ON diary.user_id = user.user_id
   			INNER JOIN avty ON user.avty_code = avty.avty_code
		<if test="key!='none'">
			WHERE ${key} LIKE CONCAT('%' #{word} '%')
		</if>
		<if test="orderBy!='none'">
			ORDER BY ${orderBy} ${orderByDir}
		</if>
		<if test="orderBy =='none'">
			ORDER BY diary.create_date DESC
		</if>
	</select>

```
ğŸ’¡ Description <br>
diary í…Œì´ë¸”ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ë•Œ user í…Œì´ë¸”ê³¼ avtyí…Œì´ë¸”ì—ì„œë„ ë°›ì•„ì™€ì•¼ í•˜ëŠ” ì •ë³´ê°€ ìˆê¸° ë•Œë¬¸ì— INNER JOIN ì„ í™œìš©í•´ì„œ í•„ìš”í•œ ì •ë³´ë¥¼ ëª¨ë‘ ë°›ì•„ì˜¤ë„ë¡ í–ˆìŠµë‹ˆë‹¤. SearchCondition dtoë¥¼ íŒŒë¼ë¯¸í„°ë¡œ ë„˜ê²¨ì¤˜ì„œ ê²€ìƒ‰ ì¡°ê±´ì— ë”°ë¼ ê°’ì„ ì¡°íšŒí•  ìˆ˜ ìˆê²Œ ë™ì ì¿¼ë¦¬ë¥¼ í™œìš©í–ˆìŠµë‹ˆë‹¤.

<hr>
<br>
<br>
<br>

**weekly diary**
```xml
	<!-- weekly ë‹¤ì´ì–´ë¦¬ ì¡°íšŒ -->
	<select id="selectMyWeeklyDiary" parameterType="String" resultMap="diaryMap">
		SELECT * 
		FROM diary
		WHERE diary.create_date BETWEEN ADDDATE( CURDATE(), - WEEKDAY(CURDATE()) + 0 ) AND ADDDATE( CURDATE(), - WEEKDAY(CURDATE()) + 6 )
	    AND user_id = #{userId}
	    GROUP BY create_date
	    ORDER BY create_date ASC;
	</select>

```
ğŸ’¡ Description <br>
userì˜ weekly diaryë¥¼ ì¡°íšŒí•´ì„œ ê°€ì ¸ì˜¤ëŠ” ì¿¼ë¦¬ë¬¸ ì…ë‹ˆë‹¤. WHERE ì¡°ê±´ì ˆì— 
```WHERE diary.create_date BETWEEN ADDDATE( CURDATE(), - WEEKDAY(CURDATE()) + 0 ) AND ADDDATE( CURDATE(), - WEEKDAY(CURDATE()) + 6 )``` ì´ë ‡ê²Œ ì¡°ê±´ì„ ì£¼ê³  ì¿¼ë¦¬ë¥¼ ë‚ ë¦¬ë©´ í˜„ì¬ ë‚ ì§œ ê¸°ì¤€ìœ¼ë¡œ create_dateê°€ ì›”í™”ìˆ˜ëª©ê¸ˆí† ì¼ ì‚¬ì´ì— ìˆëŠ” ë°ì´í„° ë“¤ë§Œ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

<hr>
<br>
<br>
<br>

**diary ì¢‹ì•„ìš”**
```xml
	<!-- ë‹¤ì´ì–´ë¦¬ ì¢‹ì•„ìš” -->
	<insert id="like" parameterType="LikeDiary">
			INSERT INTO likediary (user_id, diary_id)
			VALUES (#{userId}, #{diaryId})
	</insert>
	<!-- ë‹¤ì´ì–´ë¦¬ ì¢‹ì•„ìš” í•´ì œ -->
	<delete id="unLike" parameterType="LikeDiary">
			DELETE 
			FROM likediary
			WHERE user_id = #{userId} AND diary_id = #{diaryId}
	</delete>

```
ğŸ’¡ Description <br>
ì¢‹ì•„ìš” - likeDiary dtoì˜ userIdì™€ diaryIdì˜ ì¡°í•©ì´ likediaryì— ì¶”ê°€

ì¢‹ì•„ìš” í•´ì œ - likeDiary dtoì˜ userIdì™€ diaryIdì˜ ì¡°í•©ì´ likediaryì—ì„œ ì‚­ì œ

<hr>
<br>
<br>
<br>

**ëŒ€ëŒ“ê¸€**
```xml
	<!-- ëŒ€ëŒ“ê¸€ ì¡°íšŒ -->
	<select id="selectSubComment" resultMap="commentMap">
		SELECT * 
			FROM comment
			WHERE parent_comment = #{commentId}
	</select>
	
		<!-- ëŒ“ê¸€ ë¹„í™œì„±í™” -->
	<update id="unComment" parameterType="int">
		UPDATE comment
			SET is_deleted = NOT is_deleted
			WHERE comment_id = #{commentId}
	</update>
```
ğŸ’¡ Description <br>
commentì˜ parent_commentì— 0ì´ ì•„ë‹Œ ê°’ì´ ìˆë‹¤ë©´ í•´ë‹¹ commentëŠ” í•˜ìœ„ ëŒ“ê¸€ì´ë¼ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. parent_commentì—ëŠ” í•´ë‹¹ ëŒ“ê¸€ì˜ ë¶€ëª¨ ëŒ“ê¸€ì˜ comment_idê°€ ë‹´ê²¨ ìˆìŠµë‹ˆë‹¤. ë”°ë¼ì„œ parent_comment = commentId ì¡°ê±´ìœ¼ë¡œ ê°’ì„ ì¡°íšŒí•˜ë©´ commentIdì˜ ëŒ€ëŒ“ê¸€ì„ ì¡°íšŒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ëŒ€ëŒ“ê¸€ì´ ë‹¬ë¦° ëŒ“ê¸€ì˜ ê²½ìš° DBì—ì„œ ì‚­ì œí•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ is_deletedë¥¼ trueë¡œ ë³€ê²½ì‹œì¼œì„œ ì‚­ì œëœ ëŒ“ê¸€ì„ì„ í‘œì‹œë§Œí•˜ê³  DBì— ê°’ì„ ìœ ì§€í•˜ê²Œ ë©ë‹ˆë‹¤. is_deletedëŠ” falseê°€ defaultê°’ì…ë‹ˆë‹¤. í•´ë‹¹ ëŒ“ê¸€ì˜ í•˜ìœ„ ëŒ“ê¸€ì´ ìˆëŠ”ì§€ ì—†ëŠ”ì§€ì˜ ì—¬ë¶€ëŠ” í”„ë¡ íŠ¸ì—”ë“œì—ì„œ í™•ì¸í•˜ê³  ë°±ì—”ë“œë¡œ ìœ íš¨í•œ ìš”ì³¥ì„ ë‚ ë¦¬ëŠ” ë°©ì‹ìœ¼ë¡œ ë™ì‘í•©ë‹ˆë‹¤.

<hr>
<br>
<br>
<br>

#### 2.  userMapper.xml

```xml
	<!-- íšŒì› íƒˆí‡´ -->
	<delete id="deleteUser" parameterType="String">
		DELETE FROM user
			WHERE user_id = #{userId}
	</delete>
	
	<!-- ìœ ì € í™œì„±í™”/ë¹„í™œì„±í™” -->
	<update id="updateUserAct" parameterType="String">
		UPDATE user
			SET activate = NOT activate
			WHERE user_id = #{userId}
	</update>

```
ğŸ’¡ Description <br>
íšŒì› íƒˆí‡´ì‹œì—ëŠ” DBì—ì„œ ì •ë³´ë¥¼ ì§€ì›Œë²„ë¦¬ê³ , ë¹„í™œì„±í™” ì‹œì¼°ì„ ë•ŒëŠ” activateë¥¼ falseë¡œ ì „í™˜ì‹œì¼œì¤ë‹ˆë‹¤. activateì˜ ê¸°ë³¸ê°’ì€ trueì…ë‹ˆë‹¤. ë˜í•œ ë¹„í™œì„±í™”ëœ ê³„ì •ì˜ ê²½ìš°ëŠ” activateë¥¼ ë‹¤ì‹œ trueë¡œ ì „í™˜ì‹œì¼œì„œ í™œì„±í™”ì‹œì¼œì¤ë‹ˆë‹¤.
<hr>
<br>


## ğŸ“Œ í”„ë¡ íŠ¸

ğŸ“‚ **<u>í´ë” êµ¬ì¡°</u>**


```
ğŸ“‚ ssafy_final_project
    ã„´ ğŸ“‚ node_modules
    ã„´ ğŸ“‚ public
    ã„´ ğŸ“‚ src
        ã„´ ğŸ“‚ assets
        ã„´ ğŸ“‚ components
            ã„´ ğŸ“‚ avty
                ã„´ ğŸ“„ TheAVTYChart.vue
            ã„´ ğŸ“‚ common
                ã„´ ğŸ“„ TheFooter.vue
                ã„´ ğŸ“„ TheHeaderNav.vue
            ã„´ ğŸ“‚ diary
                ã„´ ğŸ“‚ comment
                    ã„´ ğŸ“„ Comment.vue
                ã„´ ğŸ“‚ mydiary
                    ã„´ ğŸ“„ AVTY.vue
                    ã„´ ğŸ“„ MyDiary.vue
                    ã„´ ğŸ“„ MyWeeklyDiary.vue
                    ã„´ ğŸ“„ Profile.vue
                ã„´ ğŸ“„ DiaryCreate.vue
                ã„´ ğŸ“„ DiaryList.vue
                ã„´ ğŸ“„ DiaryUpdate.vue
            ã„´ ğŸ“‚ kakao
                ã„´ ğŸ“„ KakaoLoginCheck.vue
            ã„´ ğŸ“‚ weather
                ã„´ ğŸ“„ WeatherForecast.vue
            ã„´ ğŸ“‚ youtube
                ã„´ ğŸ“„ YoutubeMusicPlayer.vue
        ã„´ ğŸ“‚ router
                ã„´ ğŸ“„ index.js
        ã„´ ğŸ“‚ stores
            ã„´ ğŸ“„ diary.js
            ã„´ ğŸ“„ user.js
            ã„´ ğŸ“„ youtube.js
        ã„´ ğŸ“‚ views
            ã„´ ğŸ“‚ diary
                ã„´ ğŸ“„ DiaryDetailView.vue
                ã„´ ğŸ“„ DiaryView.vue
                ã„´ ğŸ“„ MyPageView.vue
            ã„´ ğŸ“‚ user
                ã„´ ğŸ“„ KakaoLoginView.vue
                ã„´ ğŸ“„ LoginView.vue
                ã„´ ğŸ“„ QuizView.vue
                ã„´ ğŸ“„ SignupView.vue
                ã„´ ğŸ“„ UpdateView.vue
            ã„´ ğŸ“„ HomeView.vue
        ã„´ ğŸ“„ App.vue
        ã„´ ğŸ“„ main.js
    ã„´ ğŸ“„ .env.local
    ã„´ ğŸ“„ index.html
    ã„´ ğŸ“„ package-lock.json
    ã„´ ğŸ“„ package.json
    ã„´ ğŸ“„ vite.config.js


```


### ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸

#### 1. ì ‘ê·¼ ì½”ë“œ ë°›ê¸° (LoginView.vue)
```js
const KAKAO_API_KEY = import.meta.env.VITE_KAKAO_API_KEY;

// ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸
const kakaoLogin = () => {
    const redirect_uri = 'http://localhost:5173/kakaoLogin';
    const cliendId = KAKAO_API_KEY;
    const AuthURL = `https://kauth.kakao.com/oauth/authorize?response_type=code&client_id=${cliendId}&redirect_uri=${redirect_uri}&'scope=account_email profile_nickname'`
    window.location.href = AuthURL;

}
```
ğŸ’¡ Description <br>

`https://kauth.kakao.com/oauth` ì— ì ì ˆí•œ íŒŒë¼ë¯¸í„°ì™€ í•¨ê»˜ ìš”ì²­ì„ ë‚ ë ¤ì„œ(kakao dev api í‚¤ë¥¼ í™œìš©), ë‚´ê°€ ì„¤ì •í•œ redirect_uriì—ì„œ ì¿¼ë¦¬ ìŠ¤íŠ¸ë§ìœ¼ë¡œ codeë¼ëŠ” ê°’ì— access-tokenì„ ì „ë‹¬ ë°›ëŠ”ë‹¤.

<hr>
<br>

#### 2. access-tokenë°›ê³  í† í°ìœ¼ë¡œ ìœ ì € ì •ë³´ ë°›ê¸° (KakaoLoginCheck.vue)
```js

onMounted(()=>{
    code.value = route
    kakaoGetToken(code.value)
    userStore.getUserList()
    
})

const kakaoGetToken = () =>{
import {useRoute} from 'vue-router'
import axios from 'axios'
import { useUserStore } from '@/stores/user'

//ì¸ê°€ì½”ë“œ ì¿¼ë¦¬ë¡œ ë°›ì•„ì˜¤ê¸°
//íŒŒë¼ë¯¸í„°ê°€ ì•„ë‹ˆë¼ ì¿¼ë¦¬ìŠ¤íŠ¸ë§ìœ¼ë¡œ ë°›ì•„ì˜¤ëŠ” ê²ƒì„
const route = useRoute().query.code

    axios({
        url: 'https://kauth.kakao.com/oauth/token',
        method: 'POST',
        data:{
            grant_type: "authorization_code",
            client_id: "01bdd0d43fb0ea7f402dc99e9f0f02d4",
            redirect_uri: "http://localhost:5173/kakaoLogin",
            code: code.value
        },
        headers: {
            'Content-type': 'application/x-www-form-urlencoded;charset=utf-8'
        }
    })
    .then((res)=>{
        console.log(res.data)
        accessToken.value = res.data['access_token']
        //ìœ ì € ì •ë³´ ë°›ì•„ì˜¤ê¸°
        kakaoGetUserInfo()
    })
}

const kakaoGetUserInfo = () =>{
    axios({
        url: 'https://kapi.kakao.com/v2/user/me',
        method: 'GET',
        headers: {
            'Authorization' : `Bearer ${accessToken.value}`
        }
    })
    .then((res)=>{
        kakaoInfo.value.email = res.data["kakao_account"]["email"]
        kakaoInfo.value.nickName = res.data["kakao_account"]["profile"].nickname
    })
    .then(()=>{
        //DBì˜ ì „ì²´ ìœ ì € ë¦¬ìŠ¤íŠ¸ì—ì„œ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ ì‹œë„ ì´ë©”ì¼ê³¼ ê°™ì€ ì´ë©”ì¼ì´ ìˆë‹¤ë©´ ë¡œê·¸ì¸ í•´ì£¼ê¸°
        let kakao = userStore.users.find((user) => user.email === kakaoInfo.value.email)
        //ì¹´ì¹´ì˜¤ë¡œ íšŒì›ê°€ì… í–ˆë˜ ìœ ì €ëŠ” ë¡œê·¸ì¸ ì‹œì¼œì£¼ê¸°
        if(kakao != undefined){
            let kakaoUser = {
                userId : kakao.userId,
                userPassword: kakao.userPassword
            }
            userStore.login(kakaoUser)
            return
        }
    })
}

```
ğŸ’¡ Description <br>

ì¹´ì¹´ì˜¤ì—ì„œ ì‘ë‹µë°›ì€ codeë¥¼ `useRoute().query.code`ë¡œ ë°›ì•„ì™€ì•¼ í•©ë‹ˆë‹¤. ì´ë•Œ ì£¼ì˜í•  ì ì€ íŒŒë¼ë¯¸í„°ê°€ ì•„ë‹ˆë¼ ì¿¼ë¦¬ìŠ¤íŠ¸ë§ìœ¼ë¡œ ê°’ì´ ë„˜ì–´ì˜¤ê¸° ë•Œë¬¸ì— `route.params.code`ë¡œ ë°›ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ëŠ” ê²ƒì„ ì£¼ì˜í•´ì•¼ í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ ìš”ì²­ ë°›ì€ ì½”ë“œë¥¼ ë‹¤ë¥¸ ì ì ˆí•œ dataì™€ í•¨ê»˜ `https://kauth.kakao.com/oauth/token`ë¡œ ìš”ì²­ì„ ë‚ ë¦¬ë©´, ì¹´ì¹´ì˜¤ë¡œ ë¶€í„° access-tokenì„ ì‘ë‹µë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ë ‡ê²Œ access-tokenì„ ì‘ë‹µ ë°›ì•˜ìœ¼ë©´, ì´ì œ ìœ ì € ì •ë³´ë¥¼ ë°›ì•„ì™€ì•¼ í•©ë‹ˆë‹¤. `https://kapi.kakao.com/v2/user/me`ì— headers ``` 'Authorization' : `Bearer ${accessToken.value}` ``` ì •ë³´ë¥¼ í¬í•¨ì‹œì¼œì„œ ì ì ˆí•œ ìš”ì²­ì„ ë‚ ë¦¬ë©´ userê°€ ë™ì˜í•œ í•­ëª©ì— ëŒ€í•œ ì •ë³´ë¥¼ ì‘ë‹µë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì €í¬ ì‚¬ì´íŠ¸ì—ì„œ ë” í•„ìš”í•œ ì •ë³´ê°€ ìˆê¸° ë•Œë¬¸ì—, ì²« ë¡œê·¸ì¸ ì‹œë„ì‹œì—ëŠ” ì¶”ê°€ ì •ë³´ë¥¼ ì…ë ¥ë°›ì•„ì„œ ì €í¬ ì‚¬ì´íŠ¸ì— íšŒì›ê°€ì…ì„ í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë¡œì§ì„ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

ì´ë ‡ê²Œ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì„ í†µí•´ íšŒì›ê°€ì…í•œ ìœ ì € DBì—ëŠ” emailì— ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ email ì •ë³´ê°€ ë‹´ê¹ë‹ˆë‹¤. ì´ email ì •ë³´ëŠ” ë‹¤ìŒì— í•´ë‹¹ ìœ ì €ê°€ ì¹´ì¹´ì˜¤ ë¡œê·¸ì¸ì„ ì‹œë„í•  ë•Œ ë°”ë¡œ ë¡œê·¸ì¸í•  ìˆ˜ ìˆê²Œ í•´ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ í™œìš©í–ˆìŠµë‹ˆë‹¤.
<hr>
<br>
<br>
<br>

### íšŒì›ê°€ì…

#### 1. ìœ íš¨ì„± ê²€ì‚¬

```js
const regist = function (event) {
    // ìœ íš¨ì„± ê²€ì‚¬
    // 1. ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ê³¼ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ì…ë ¥ì˜ ì¼ì¹˜ ì—¬ë¶€
    if (user.value.userPassword != password2.value) {
        alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.').
            return;
    }
    // 2. ë¹„ë°€ë²ˆí˜¸ê°€ 8ìë¦¬ ì´ìƒ, 16ì ì´í•˜ì´ë©° íŠ¹ìˆ˜ë¬¸ì(!@#$%^&*)
    const pattern = /[!@#$%^&*]/
    if (user.value.userPassword.length < 8 || user.value.userPassword.length > 16 || !pattern.test(user.value.userPassword)) {
        alert('ë¹„ë°€ë²ˆí˜¸ëŠ” 8ìë¦¬ ì´ìƒ, 16ìë¦¬ ì´í•˜ì´ë©°, íŠ¹ìˆ˜ë¬¸ì(!@#$%^&*)ë¥¼ í¬í•¨í•´ì•¼ í•©ë‹ˆë‹¤.')
        return
    }

    // 3. ì´ë¯¸ ë“±ë¡ëœ ID, ë‹‰ë„¤ì„ì¸ì§€ ì¤‘ë³µ ì—¬ë¶€ í™•ì¸
    axios.get("http://localhost:8080/user-api/user")
    .then((res) => {
        checkId.value = res.data.find(
            (u) => u.userId === user.value.userId
        );
        nickNameCheck.value = res.data.find(
            (u) => u.nickName === user.value.nickName
        );
    })
    .then(() => {

        if (checkId.value) {
            alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” IDì…ë‹ˆë‹¤.');
            return
        }
        if (nickNameCheck.value) {
            alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ë‹‰ë„¤ì„ì…ë‹ˆë‹¤.');
            return
        }
        signup()
    })

    const signup = () => {

        //íšŒì› ê°€ì… ë¡œì§ ìƒëµ
    }

};

```
ğŸ’¡ Description <br>
- ë¹„ë°€ë²ˆí˜¸ ì¼ì¹˜ í™•ì¸ ê²€ì‚¬
- ë¹„ë°€ë²ˆí˜¸ 8ìë¦¬ ì´ìƒ, 16ìë¦¬ ì´í•˜, íŠ¹ìˆ˜ë¬¸ì í¬í•¨ ê²€ì‚¬
- ì¤‘ë³µ ID ì™€ nickname ê²€ì‚¬

<hr>
<br>

#### 2. ëœë¤ ë‹‰ë„¤ì„ ì¶”ì²œ
```js
const randomNickName = ref('')

//ëœë¤ ë‹‰ë„¤ì„ ë¶ˆëŸ¬ì˜¤ê¸°
onMounted(() => {
    axios({
        //corsì—ëŸ¬ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ ì„ì‹œë¡œ ì¸ì¦ë°›ê³  ì²˜ë¦¬
        url: `https://cors-anywhere.herokuapp.com/https://nickname.hwanmoo.kr?format=json`,
        method: 'GET',
        headers: {
            'Access-Control-Allow-Origin': '*'
        }
    })
    .then((response) => {
        // console.log(response['data'].words[0])
        randomNickName.value = response['data'].words[0]
        user.nickName = randomNickName.value
        // console.log(user.nickName)
    })
    .catch((error) => {
        console.log(error)
    })

})

```
ğŸ’¡ Description <br>
ëœë¤ ë‹¨ì–´ë¥¼ json í˜•ì‹ìœ¼ë¡œ ì‘ë‹µë°›ì„ ìˆ˜ ìˆëŠ” `https://nickname.hwanmoo.kr?format=json`ê°€ ìˆëŠ”ë°, ì—¬ê¸°ì„œ ì‘ë‹µ ë°›ì•„ì˜¨ ëœë¤ ë‹¨ì–´ë¥¼ íšŒì› ê°€ì…ì‹œì— ì¶”ì²œ ë‹‰ë„¤ì„ìœ¼ë¡œ ì œê³µí•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ ì´ë•Œ CORS ì—ëŸ¬ê°€ ë°œìƒí•´ì„œ `https://cors-anywhere.herokuapp.com` ë¼ëŠ” cross-origin ìš”ì²­ì„ ì„ì‹œë¡œ ê°€ëŠ¥í•˜ê²Œ í•´ì£¼ëŠ” APIê°€ ìˆì–´ì„œ, ì´ë¥¼ í™œìš©í•´ì„œ CORSì—ëŸ¬ë¥¼ ì„ì‹œì ìœ¼ë¡œ í•´ê²°í•´ì„œ ëœë¤ ë‹‰ë„¤ì„ì„ ë°›ì•„ì™”ìŠµë‹ˆë‹¤.

<hr>
<br>
<br>
<br>

### AVTY í€´ì¦ˆ

#### 1. í€´ì¦ˆ ì§„í–‰ ë° ê²°ê³¼
```js
// 1. ë©”ì¸ í˜ì´ì§€ì—ì„œ ì§ˆë¬¸ í˜ì´ì§€ë¡œ ë„˜ì–´ê°€ê¸°
const begin = function () {
    setTimeout(() => {
        styleObjMain.value['display'] = 'none';
        styleObjStatusBar.value['display'] = 'block';
        styleQbox.value['display'] = 'block';
        styleObjQna.value['display'] = 'block';
    }, 200)

    // ì§ˆë¬¸ ë‚˜ì˜¤ê²Œ í•˜ëŠ” goNext() í˜¸ì¶œ
    let qIdx = 0;
    goNext(qIdx);
}

// 2. ì§ˆë¬¸ í˜ì´ì§€ì˜ ì²« ë²ˆì§¸ ì§ˆë¬¸ê³¼ ì‘ë‹µ ë‚˜ì˜¤ê²Œ í•˜ê¸°
function goNext(qIdx) {
    // ë§ˆì§€ë§‰ ì§ˆë¬¸ì´ë©´ ê²°ê³¼ ë‚˜ì˜¤ê²Œí•˜ëŠ” goResult() í˜¸ì¶œí•˜ê³  return
    if (qIdx === endPoint) {
        goResult();
        return;
    }

    let qBox = document.querySelector('.qBox');
    // `qnaList`ì˜ qIdxë²ˆì§¸ ì¸ë±ìŠ¤ì˜ `q`ê°€ ë“¤ì–´ì˜¤ë„ë¡
    qBox.innerHTML = qnaList[qIdx].q;

    // `qnaList`ì˜ qIdxë²ˆì§¸ ì¸ë±ìŠ¤ì˜ `a` ë°°ì—´ ië²ˆ ë°˜ë³µ(ì„ íƒì§€)
    for (let i in qnaList[qIdx].a) {
        // addAnswer()ì— `qnaList`ì˜ qIdxë²ˆì§¸ ì¸ë±ìŠ¤ì˜ `a` ë°°ì—´ì˜ ië²ˆì§¸ ì¸ë±ìŠ¤ì˜ answerì™€ qIdxë¥¼ ì¸ìë¡œ ì „ë‹¬
        addAnswer(qnaList[qIdx].a[i].answer, qIdx, i);
    }

    // ì§„í–‰ìƒíƒœ ë³´ì—¬ì£¼ëŠ” var
    let status = document.querySelector('.statusBar');
    styleObjStatusBar.value['width'] = (100 / endPoint) * (qIdx + 1) + '%';
}

// 3. 9ê°œì˜ ì§ˆë¬¸ì— ëŒ€í•œ ë‹µ ì„ íƒí•˜ê³  -> ë‹¤ìŒ ì§ˆë¬¸ìœ¼ë¡œ ë„˜ì–´ê°€ê¸°
function addAnswer(answerText, qIdx, idx) {

    // ì‘ë‹µ ì „ì²´ë¥¼ ë‹´ëŠ” ë°•ìŠ¤
    let answerBox = document.querySelector('.answerBox');

    // 2ê°€ì§€ ì‘ë‹µë²„íŠ¼
    let answer = document.createElement('button');
    answer.classList.add('answerList');

    // ì‘ë‹µ ì „ì²´ ë°•ìŠ¤ì— ê°œë³„ ì‘ë‹µë²„íŠ¼ ë„£ê¸°
    answerBox.appendChild(answer);
    // ê°œë³„ ì‘ë‹µ ë²„íŠ¼ì— íŒŒë¼ë¯¸í„°ë¡œ ë°›ì€ answerText(=qnaList[qIndx].a[i].answer) ë„£ê¸°
    answer.innerHTML = answerText;

    // ë²„íŠ¼ í´ë¦­í•  ë•Œë§ˆë‹¤ ë°œìƒí•˜ëŠ” ì´ë²¤íŠ¸ ì ìš©
    answer.addEventListener("click", function () {
        // ëª¨ë“  ì‘ë‹µë²„íŠ¼ childrenì— ë‹´ê¸°
        let children = document.querySelectorAll('.answerList');

        // ëª¨ë“  ì‘ë‹µë²„íŠ¼ ë°˜ë³µ
        for (let i = 0; i < children.length; i++) {
            // ëª¨ë“  ì‘ë‹µë²„íŠ¼ ë¹„í™œì„±í™”
            children[i].disabled = true;
        }

        setTimeout(() => {
            var target = qnaList[qIdx].a[idx].type;
            for (let i = 0; i < target.length; i++) {
                select.value[target[i]] += 1;
            }

            for (let i = 0; i < children.length; i++) {
                children[i].style.display = 'none';
            }
            // ë‹¤ìŒ ì§ˆë¬¸ìœ¼ë¡œ ë„˜ì–´ê°€ê¸°
            goNext(++qIdx);
        }, 200)
    }, false);
}

// 4. ë§ˆì§€ë§‰ ì§ˆë¬¸ì—ì„œ ì‘ë‹µê²°ê³¼ë¡œ ë„˜ì–´ê°€ê¸°
function goResult() {
    // 0.2ì´ˆ ë’¤ì—
    setTimeout(() => {
        // qnaëŠ” ì™„ì „íˆ ì‚¬ë¼ì§€ê³ , ê²°ê³¼ëŠ” ì™„ì „íˆ ë‚˜íƒ€ë‚˜ê¸° ì ìš©
        styleObjQna.value['display'] = 'none';
        styleObjResult.value['display'] = 'block';
    }, 200)

    // ê²°ê³¼ë¥¼ êµ¬í˜„í•˜ëŠ” í•¨ìˆ˜ í˜¸ì¶œ
    setResult();
}

// 5. ìµœì¢…ê²°ê³¼ë¥¼ ë³´ì—¬ì£¼ê¸° ìœ„í•œ ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„

// ê³ ë¥¸ ì‘ë‹µë“¤ì˜ ì ìˆ˜ë¥¼ ë§¤ê¸°ê¸° ìœ„í•œ ë³€ìˆ˜
const select = ref([0, 0, 0, 0, 0, 0, 0, 0]);

// ìµœì¢… ì‘ë‹µ ê²°ê³¼ ê³„ì‚° í•¨ìˆ˜
function calResult() {
    console.log(select.value);
    // ê³ ë¥¸ ì‘ë‹µë“¤ì˜ ì ìˆ˜ë¥¼ ë§¤ê¸°ê¸°ìœ„í•œ select ë³€ìˆ˜ë¥¼ ì „ê°œ
    // Mathë©”ì„œë“œì— ë„£ì–´ ì ìˆ˜ê°€ ë§¤ê²¨ì§„ ë°°ì—´ì˜ ìµœëŒ€ê°’ì„ êµ¬í•¨!
    // indexOfë©”ì„œë“œì˜ ì¸ìˆ˜ë¡œ ì „ë‹¬ëœ ìš”ì†Œë¥¼ ê²€ìƒ‰í•´ì„œ
    let result = select.value.indexOf(Math.max(...select.value));
    // ê²€ìƒ‰ëœ í•´ë‹¹ ì¸ë±ìŠ¤ ë²ˆí˜¸ë¥¼ ë°˜í™˜
    return result;
}

function setResult() {
    // returnëœ resultê°’ pointì— ë‹´ê¸°
    // result -> ìµœëŒ€ê°’ì´ ë°œê²¬ëœ ì¸ë±ìŠ¤ ë²ˆí˜¸!
    let point = calResult();

    // ê²°ê³¼ ì´ë¦„ ë‹´ê¸°
    const resultName = document.querySelector('.resultName');
    // infoList[ìµœëŒ€ê°’ì´ ë°œê²¬ëœ indexë²ˆí˜¸]ì˜ nameì„ ë‹´ê¸°
    // const loginUser = JSON.parse(localStorage.getItem('loginUser'))
    userStore.loginUser.avtyCode = point;
    avty.value = userStore.loginUser.avtyCode
    // const userName = loginUser.userName;

    // ê²€ì‚¬ ê²°ê³¼ë¥¼ DBì— ë°˜ì˜
    axios
        .put(`http://localhost:8080/user-api/user/${userStore.loginUser.userId}`, userStore.loginUser, {
            headers: {
                'access-token': sessionStorage.getItem('access-token')
            }
        })
        .then(() => {
            console.log('ì •ë³´ìˆ˜ì •ì— ì„±ê³µí•˜ì˜€ìŠµë‹ˆë‹¤!');
        }).catch(() => {
            console.log("ì •ë³´ìˆ˜ì •ì— ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤!")
        })
    // localStorage.setItem('loginUser', JSON.stringify(loginUser))

    resultName.innerHTML = userStore.loginUser.userName + `ë‹˜ì€ ` + infoList[point].name + ` ìœ í˜•ì…ë‹ˆë‹¤ !`;
    // ê²°ê³¼ ì´ë¯¸ì§€ ë„ìš°ê¸°
    let resultImg = document.createElement('img');
    const imgDiv = document.querySelector('#resultImg');
    let imgURL = 'src/assets/avty_image/avty-' + point + '.jpg';
    resultImg.src = imgURL;
    resultImg.alt = point;
    resultImg.width = 250;
    imgDiv.appendChild(resultImg);

    // ê²°ê³¼ ì„¤ëª… ë‹´ê¸°
    const resultDesc = document.querySelector('.resultDesc');
    // infoList[ìµœëŒ€ê°’ì´ ë°œê²¬ëœ indexë²ˆí˜¸]ì˜ descë¥¼ ë‹´ê¸°
    for (let i = 0; i < infoList[point].desc.length; i++) {
        resultDesc.innerHTML += '<p id="descList">' + infoList[point].desc[i] + '</p>';
    }
    // resultDesc.innerHTML = infoList[point].desc;
}
```

#### 2. Apex Chart
```html
<template>
    <div style="text-align: center;">
        <div id="chart">
            <p>GYM STAGRAM íšŒì›AVTY í˜„í™©</p>
            <VueApexCharts type="donut" :options="chartOptions" :series="avtyRate"></VueApexCharts>
        </div>
    </div>
</template>

<script setup>
import {ref} from 'vue'
import VueApexCharts from 'vue3-apexcharts'

 const props = defineProps({
    avtyData: Object
})
const avtyRate = ref([])
const avtyName= ref( [])

avtyRate.value = Object.values(props.avtyData)
avtyName.value = Object.keys(props.avtyData)

const chartOptions = ref({
    chart:{
        width: 200,
        height: 300,
        type: 'donut',
    },
    labels: ['ENJ', 'ENP', 'ESJ', 'ESP', 'INJ', 'INP', 'ISJ', 'ISP'],
    colors:["#A099FB", "#FE79AB", "#01CECB", "#f32c52", "#FCE38A", "#79AC78", "#96B6C5", "#B3A492"],
    fill: {
    colors: ["#A099FB", "#FE79AB", "#01CECB", "#f32c52", "#FCE38A", "#79AC78", "#96B6C5", "#B3A492"]
    },

    responsive: [{
        breakpoint: 480,
        options: {
            chart: {
                width: 200
            },
            legend: {
                position: 'bottom'
            },
         }
    }]
})

</script>
```
ğŸ’¡ Description <br>
ì‚¬ìš©ìê°€ í€´ì¦ˆë¥¼ ì§„í–‰í•  ìˆ˜ ìˆê³ , í€´ì¦ˆì˜ ê²°ê³¼ì— ë”°ë¼ AVTY ì½”ë“œ ê°’ì´ ìœ ì € DBì— ì €ì¥ë©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ì‚¬ìš©ìëŠ” í˜„ì¬ íšŒì›ì˜ AVTY ë¹„ìœ¨ì„ ë„ë„› ì°¨íŠ¸ë¡œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<hr>
<br>
<br>
<br>

### ì˜¤í”ˆ API

#### ê³µê³µ ë°ì´í„° í¬íƒˆ / Kakao Map

``` js
    // ë‚´ ìœ„ì¹˜ì •ë³´ êµ¬í•˜ê¸°
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition((position) => {
            latitude.value = position.coords.latitude; // ìœ„ë„
            longitude.value = position.coords.longitude; // ê²½ë„
            // console.log("ìœ„ë„, ê²½ë„ : " + latitude.value + " " + longitude.value)
            // ë‚´ ìœ„ì¹˜(ê²½ë„, ìœ„ë„) -> ë²•ì •ë™
            const Location_API_URL = `https://dapi.kakao.com/v2/local/geo/coord2regioncode.json?x=${longitude.value}&y=${latitude.value}`;
            axios
                .get(Location_API_URL, {
                    headers: {
                        Authorization: `KakaoAK ${import.meta.env.VITE_KAKAO_API_KEY}`,
                    }
                }).then((response) => {
                    //ë²•ì •ë™ ê¸°ì¤€ìœ¼ë¡œ ë™ë‹¨ìœ„ì˜ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤
                    location.value = response.data.documents[0].address_name;
                    // console.log(location.value)
                })

            // ì¢Œí‘œë¡œ í–‰ì •êµ¬ì—­ ì •ë³´ ë°›ê¸°
            // ìœ„ë„, ê²½ë„ -> ê¸°ìƒì²­ ì¢Œí‘œë¡œ ë³€í™˜
            let RE = 6371.00877; // ì§€êµ¬ ë°˜ê²½(km)
            let GRID = 5.0; // ê²©ì ê°„ê²©(km)
            let SLAT1 = 30.0; // íˆ¬ì˜ ìœ„ë„1(degree)
            let SLAT2 = 60.0; // íˆ¬ì˜ ìœ„ë„2(degree)
            let OLON = 126.0; // ê¸°ì¤€ì  ê²½ë„(degree)
            let OLAT = 38.0; // ê¸°ì¤€ì  ìœ„ë„(degree)
            let XO = 43; // ê¸°ì¤€ì  Xì¢Œí‘œ(GRID)
            let YO = 136; // ê¸°1ì¤€ì  Yì¢Œí‘œ(GRID)

            function dfs_xy_conv(v1, v2) {
                let DEGRAD = Math.PI / 180.0;
                let RADDEG = 180.0 / Math.PI;

                let re = RE / GRID;
                let slat1 = SLAT1 * DEGRAD;
                let slat2 = SLAT2 * DEGRAD;
                let olon = OLON * DEGRAD;
                let olat = OLAT * DEGRAD;

                let sn = Math.tan(Math.PI * 0.25 + slat2 * 0.5) / Math.tan(Math.PI * 0.25 + slat1 * 0.5);
                sn = Math.log(Math.cos(slat1) / Math.cos(slat2)) / Math.log(sn);
                let sf = Math.tan(Math.PI * 0.25 + slat1 * 0.5);
                sf = Math.pow(sf, sn) * Math.cos(slat1) / sn;
                let ro = Math.tan(Math.PI * 0.25 + olat * 0.5);
                ro = re * sf / Math.pow(ro, sn);
                let rs = {};

                rs['lat'] = v1;
                rs['lng'] = v2;
                let ra = Math.tan(Math.PI * 0.25 + (v1) * DEGRAD * 0.5);
                ra = re * sf / Math.pow(ra, sn);
                let theta = v2 * DEGRAD - olon;
                if (theta > Math.PI) theta -= 2.0 * Math.PI;
                if (theta < -Math.PI) theta += 2.0 * Math.PI;
                theta *= sn;
                rs['x'] = Math.floor(ra * Math.sin(theta) + XO + 0.5);
                rs['y'] = Math.floor(ro - ra * Math.cos(theta) + YO + 0.5);

                return rs;
            }
            let x = dfs_xy_conv(latitude.value, longitude.value)['x']
            let y = dfs_xy_conv(latitude.value, longitude.value)['y']
            // console.log("ê¸°ìƒì²­ ì¢Œí‘œ : " + x + " " + y)

            // ê³µê³µë°ì´í„°ì—ì„œ ìš”ì²­ ë‚ ë¦¬ë¼ê³  í•œ URL
            const Weather_API_URL = `http://apis.data.go.kr/1360000/VilageFcstInfoService_2.0/getVilageFcst`;

            month = month < 10 ? "0" + month : month;
            date = date < 10 ? "0" + date : date;
            const todayStr = `${year}${month}${date}`;

            axios
                .get(Weather_API_URL, {
                    params: {
                        ServiceKey: import.meta.env.VITE_WEATHER_API_KEY,
                        dataType: "JSON",
                        base_date: todayStr,
                        base_time: timeChange(hour),
                        numOfRows: 15,
                        nx: x,
                        ny: y,
                    },
                })
                .then((response) => {
                    return response.data.response.body.items.item;
                })
                .then((response) => {
                    //TMP : 1ì‹œê°„ ê¸°ì˜¨ â„ƒ
                    //UUU : í’ì†(ë™ì„œ) m/s
                    //VVV : í’ì†(ë‚¨ë¶) m/s
                    //VEC : í’í–¥ deg
                    //WSD : í’ì† m/s
                    //SKY : í•˜ëŠ˜ìƒíƒœ --> ì½”ë“œ : ë§‘ìŒ(1), êµ¬ë¦„ë§ìŒ(3), íë¦¼(4)
                    //PTY : ê°•ìˆ˜í˜•íƒœ --> ì½”ë“œ : ì—†ìŒ(0), ë¹„(1), ë¹„/ëˆˆ(2), ëˆˆ(3), ì†Œë‚˜ê¸°(4)
                    //POP : ê°•ìˆ˜í™•ë¥  %
                    //WAV : íŒŒê³  M
                    //PCP : 1ì‹œê°„ ê°•ìˆ˜ëŸ‰ ë²”ì£¼(1mm)
                    //REH : ìŠµë„ %
                    //SNO : 1ì‹œê°„ ì ì„¤ëŸ‰
                    //TMN : ì¼ ìµœì €ê¸°ì˜¨ â„ƒ x
                    //TMX : ì¼ ìµœê³ ê¸°ì˜¨ â„ƒ x
                    response.forEach((item) => {
                        // 1ì‹œê°„ ê¸°ì˜¨
                        if (item.category === "TMP") {
                            tmp.value = item.fcstValue;
                        } else if (item.category === "SKY") {
                            switch (item.fcstValue) {
                                case "1":
                                    sky.value = "ë§‘ìŒ";
                                    weatherIcon.value = "â˜€ï¸";
                                    recommendContent.value = '<div class="today-recommend">í…Œë‹ˆìŠ¤, ì¶•êµ¬, ë“±ì‚°, ì•¼êµ¬</div>'
                                    recommendIcon.value[0] = 'ğŸ¾'
                                    recommendIcon.value[1] = 'âš½'
                                    recommendIcon.value[2] = 'â›°ï¸'
                                    recommendIcon.value[3] = 'âš¾ï¸'
                                    break;
                                case "3":
                                    sky.value = "êµ¬ë¦„ë§ìŒ";
                                    weatherIcon.value = "â›…";
                                    recommendContent.value = '<div class="today-recommend">ë†êµ¬, ë°°êµ¬, ê³¨í”„, ë°°ë“œë¯¼í„´</div>'
                                    recommendIcon.value[0] = 'â›¹ï¸'
                                    recommendIcon.value[1] = 'ğŸ'
                                    recommendIcon.value[2] = 'â›³'
                                    recommendIcon.value[3] = 'ğŸ¸'
                                    break;
                                case "4":
                                    sky.value = "íë¦¼";
                                    weatherIcon.value = "â˜ï¸";
                                    recommendContent.value = '<div class="today-recommend">íƒêµ¬, ëŸ¬ë‹, ì¶•êµ¬, ë“±ì‚°</div>'
                                    recommendIcon.value[0] = 'ğŸ“'
                                    recommendIcon.value[1] = 'ğŸƒâ€â™€'
                                    recommendIcon.value[2] = 'âš½'
                                    recommendIcon.value[3] = 'â›°ï¸'
                                    break;
                            }
                        } else if (item.category === "PTY") {
                            switch (item.fcstValue) {
                                case "1":
                                    weatherIcon.value = "ğŸŒ§ï¸";
                                    recommendContent.value = '<div class="today-recommend">ìˆ˜ì˜, í´ë¼ì´ë°, ìš”ê°€, ë³¼ë§</div>'
                                    recommendIcon.value[0] = 'ğŸŠâ€â™€ï¸'
                                    recommendIcon.value[1] = 'ğŸ§—â€â™‚'
                                    recommendIcon.value[2] = 'ğŸ§˜ğŸ»â€â™€ï¸'
                                    recommendIcon.value[3] = 'ğŸ³'
                                    break;
                                case "2":
                                    weatherIcon.value = "â„ï¸";
                                    recommendContent.value = '<div class="today-recommend">ìŠ¤í‚¤, ìŠ¤ë…¸ë³´ë“œ, ì»¬ë§, ë³¼ë§</div>'
                                    recommendIcon.value[0] = 'ğŸ¿'
                                    recommendIcon.value[1] = 'ğŸ‚'
                                    recommendIcon.value[2] = 'ğŸ¥Œ'
                                    recommendIcon.value[3] = 'ğŸ³'
                                    break;
                                case "3":
                                weatherIcon.value = "â„ï¸";
                                    recommendContent.value = '<div class="today-recommend">ìŠ¤í‚¤, ìŠ¤ë…¸ë³´ë“œ, ì»¬ë§, ë³¼ë§</div>'
                                    recommendIcon.value[0] = 'ğŸ¿'
                                    recommendIcon.value[1] = 'ğŸ‚'
                                    recommendIcon.value[2] = 'ğŸ¥Œ'
                                    recommendIcon.value[3] = 'ğŸ³'
                                    break;
                                case "4":
                                    weatherIcon.value = "ğŸŒ§ï¸";
                                    recommendContent.value = '<div class="today-recommend">ìˆ˜ì˜, í´ë¼ì´ë°, ìš”ê°€, ë³¼ë§</div>'
                                    recommendIcon.value[0] = 'ğŸŠâ€â™€ï¸'
                                    recommendIcon.value[1] = 'ğŸ§—â€â™‚'
                                    recommendIcon.value[2] = 'ğŸ§˜ğŸ»â€â™€ï¸'
                                    recommendIcon.value[3] = 'ğŸ³'
                                    break;
                            }
                        } else if (item.category === "POP") {
                            pop.value = item.fcstValue;
                        } else if (item.category === "WSD") {
                            wsd.value = item.fcstValue;
                        }
                    });
                });
        })
    }
```

ğŸ’¡ Description <br>
geolocation APIë¥¼ ì‚¬ìš©í•˜ì—¬ í˜„ì¬ ìœ„ì¹˜ì˜ ìœ„ë„, ê²½ë„ë¥¼ ë°›ì•„ì™€ì„œ KAKAO REST APIë¥¼ í™œìš©í•˜ì—¬ í–‰ì •êµ¬ì—­ ì •ë³´ ë°›ì•„ì„œ ì¶œë ¥í•©ë‹ˆë‹¤.
ê³µê³µ ë°ì´í„° í¬íƒˆì˜ ë‹¨ê¸°ì˜ˆë³´ ì˜¤í”ˆ APIë¥¼ í™œìš©í•˜ê¸° ìœ„í•´ ìœ„ë„, ê²½ë„ê°’ì„ X, Y ì¢Œí‘œê°’ìœ¼ë¡œ ë³€í™˜í•´ í˜„ìœ„ì¹˜ì˜ ë‚ ì”¨ ì •ë³´ ì¶œë ¥í•©ë‹ˆë‹¤.
ê³µê³µ ë°ì´í„° í¬íƒˆì—ì„œ ì œê³µí•´ì£¼ëŠ” API ì„¤ëª…ì§‘ì— í¬í•¨ëœ ì—‘ì…€ íŒŒì¼ì— ì €ì¥ëœ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ê±°ë‚˜, ë³€í™˜í•´ì£¼ëŠ” í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


#### ì¶”ì²œ ìŒì•… ì¬ìƒ (AVTY.vue)
```html
    <v-card-title>ğŸ™ï¸ì¶”ì²œ ë…¸ë˜ğŸ™ï¸</v-card-title>

    <div class="px-4" style="margin-bottom: 2em;;">
      <v-chip-group v-model="selection" selected-class="text-deep-purple-accent-4" style="justify-content: center;">
        <template v-for="song in infoList[userStore.loginUser.avtyCode].songs">
          <v-chip @click="playMusic(song), isPlaying = !isPlaying">ğŸ¶ {{ song }}</v-chip>
        </template>
      </v-chip-group>
    </div>

    <div class="play-box">
    </div>
    <template v-if="isPlaying">
      <div class="container">
        <YoutubeMusicPlayer class="youtube-list" v-for="(video, index) in youtubeStore.videos" :key="video.id.videoId"
          :video="video" :index="index" :current="current" />
      </div>
    </template>

    <script setup>
        import { ref } from 'vue'
        import { useYoutubeStore } from "@/stores/youtube";
        import YoutubeMusicPlayer from "@/components/youtube/YoutubeMusicPlayer.vue";

        const youtubeStore = useYoutubeStore()
        const playMusic = (keyword) => {
        console.log(keyword)
        youtubeStore.youtubeSearchByKeyword(keyword)
        }

        const infoList = ref([
            {
                name: 'ENJ',
                desc: [
                "ê³„íš ì„¸ìš°ëŠ” ê²ƒğŸ—“ï¸ì„ ì¢‹ì•„í•˜ëŠ” ì‚¬ëŒì´ì—ìš”.",
                "ìš´ë™í•˜ê¸°ë¡œ ë§ˆìŒ ë¨¹ì€ ë‚ ì— ê³„íšì„ ì„¸ì›Œ ë°”ë¡œ ì‹¤ì²œí•  ìˆ˜ ìˆëŠ” ìš´ë™ì´ ì–´ìš¸ë ¤ìš”.",
                "ì¶”ì²œí•˜ëŠ” ìš´ë™ì€ ëŸ¬ë‹ê³¼ í—¬ìŠ¤ğŸƒğŸ»â€â™‚ï¸ì—ìš”!",
                ],
                songs: ['Baddie - IVE(ì•„ì´ë¸Œ)', 'Hype Boy - NewJeans(ë‰´ì§„ìŠ¤)', 'Perfect Night - ë¥´ì„¸ë¼í•Œ']
            },
        // ì¤‘ëµ...
        ])

  </script>
```
<br>
<br>

#### Youtube (YoutubeMusicPlayer.vue)
```html
<template>
  <div style="display: none;">
      <iframe
        width="300"
        height="200"
        :src="videoURL"
        title="YouTube video player"
        frameborder="1"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        allowfullscreen
      ></iframe>
  </div>
</template>

<script setup>
import { computed } from "vue";
const props = defineProps({
  video: {
    type: Object,
    required: true,
  },
  index: Number,
  current: Number,
});
const videoURL = computed(() => {
  const videoId = props.video.id.videoId;
  return `https://www.youtube.com/embed/${videoId}?start=80&end=100&autoplay=1&mute=0`;
});

</script>
```
ğŸ’¡ Description <br>
` playMusic(song), isPlaying = !isPlaying"`  í•¨ìˆ˜ë¥¼ í†µí•´ì„œ ì¬ìƒí•˜ë ¤ê³  í•˜ëŠ” ìŒì•…ì˜ ì´ë¦„ì„ keywordë¡œ Youtube APIì— ê²€ìƒ‰ ìš”ì²­ì„ í•˜ë©´, í•´ë‹¹í•˜ëŠ” ìŒì•… ì˜ìƒì´ ìë™ ì¬ìƒë˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

isPlayingì´ true ê°’ì´ë©´ v-if="isPlaying" ì¡°ê±´ìœ¼ë¡œ YoutubeMusicPlayer.vue ê°€ ë Œë”ë§ ë˜ì–´ì„œ ìŒì•…ì´ ì¬ìƒë˜ê³ , falseë©´ YoutubeMusicPlayer.vue ê°€ ë Œë”ë§ ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— v-if ì†ì„±ì˜ íŠ¹ì§•ì„ í™œìš©í•´ì„œ ë§ˆì¹˜ ìŒì•…ì„ ì¬ìƒí•˜ê³  ì¤‘ì§€í•˜ëŠ” íš¨ê³¼ë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

ì‚¬ìš©ìëŠ” AVTY ê²°ê³¼ ì¢…ë£Œí›„ ê²°ê³¼ í™”ë©´ì—ì„œ í˜¹ì€ í…ŒìŠ¤íŠ¸ í›„ í”„ë¡œí•„ í™”ë©´ì—ì„œ ì¶”ì²œìŒì•…ì„ ë¯¸ë¦¬ë“£ê¸° í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë•Œ Youtube APIë¥¼ í™œìš©í•´ì„œ ì˜ìƒ ê²€ìƒ‰ ì¿¼ë¦¬ë¥¼ í†µí•´ ìŒì•…ì„ ê°€ì ¸ì˜¤ê³ , src ê²½ë¡œì— ê°’ì„ ì¡°ì •í•´ì„œ ìë™ì¬ìƒê³¼ ì›í•˜ëŠ” êµ¬ê°„ë§Œí¼ ì¬ìƒí•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•´ ì¤ë‹ˆë‹¤. 
- `https://www.youtube.com/embed/${videoId}?start=80&end=100&autoplay=1mute=0` 
- start=80 : 80ì´ˆ ë¶€í„° ì¬ìƒ
- end=100 : 100ì´ˆê¹Œì§€ ì¬ìƒ
- autoplay=1 : ìë™ ì¬ìƒ
- mute=0 : ì†Œë¦¬ ì¼¬

<hr>
<br>
<br>
<br>


### ì´ë¯¸ì§€ íŒŒì¼ ì—…ë¡œë“œ

#### 1. Drag & Drop

```html
<div class="input-group" >
    <label for="file" ref="filebtn" > </label>
    <input type="file" id="file" class="form-control" @change="upload" :ref="image"  accept="image/.*">
</div>

<!--Drag & Drop íŒŒì¼ ì—…ë¡œë“œ-->
<div 
    @dragenter="onDragenter"
    @dragover.prevent="onDragover"
    @dragleave="onDragleave"
    @drop.prevent="onDrop"
    @click="$refs.filebtn.click()"
    @change="upload"
        :ref="image"
    class="drag-box">
    <img :src="imageUploaded" style="width: 20rem; margin-top: 10px" />
</div>
<div class="d-flex justify-content-center " style="margin-top: 10px;">
    <v-btn class="create-btn" @click="createDiary($event)">ë“±ë¡</v-btn>
    <v-btn class="close-btn" @click="close">ë‹«ê¸°</v-btn>
</div>
                
<script setup>
import { ref } from 'vue'
import { useUserStore } from '@/stores/user'
import axios from 'axios';
import { useRouter } from 'vue-router';

const router = useRouter()
const userStore = useUserStore()


const diary = ref({
    userId: "",
    originalImage: "",
    title: "",
    content: "",
    saveImage:"",
})

const isDragged = ref(false)

const onDragenter = function(event){
    isDragged.value = true
}

const onDragleave = function(event){
    isDragged.value = false
}

const onDrop = function(event){
    isDragged.value = false
    const file = event.dataTransfer.files
    dragUpload(file[0])
}

const dragUpload = function (file) {
    console.log(file)
    image.value = file
    imageUploaded.value = URL.createObjectURL(image.value)
    uploadName.value = image.value.name;
}
</script>
``` 
ğŸ’¡ Description <br>
 `@click="$refs.filebtn.click()` :  drag & drop box ì˜ì—­ì„ ëˆŒë €ì„ ë•Œ íŒŒì¼ì²¨ë¶€ ë²„íŠ¼ì„ ëˆ„ë¥´ëŠ” ì´ë²¤íŠ¸ë¥¼ ê±¸ì–´ì„œ ë°œìƒì‹œì¼œì¤ë‹ˆë‹¤.

`@dragover.prevent="onDragover" @drop.prevent="onDrop"`  :  dragoverì™€ dropì˜ ê¸°ë³¸ ì´ë²¤íŠ¸ë¥¼ ë§‰ì•„ì£¼ê³  isDragged ref ë³€ìˆ˜ë¥¼ ì¡°ì‘í•©ë‹ˆë‹¤. ê·¸ë¦¬ê³  dropì´ ë°œìƒí•˜ë©´ í•´ë‹¹ ì´ë²¤íŠ¸ì˜ target íŒŒì¼ì„ ì—…ë¡œë“œí•©ë‹ˆë‹¤.

<hr>
<br>
<br>

#### 2. ì´ë¯¸ì§€ íŒŒì¼ì„ Base64 ë¬¸ìì—´ë¡œ ì¸ì½”ë”©
```js
const createDiary = function (event) {

    diary.value.userId = userStore.loginUser.userId

    if (image.value != null) {
        //íŒŒì¼ ì½ê¸°
        var reader = new FileReader();
        reader.readAsDataURL(image.value)
        //readystate == 2ì¼ ë•Œ resultì— ì´ë¯¸ì§€ íŒŒì¼ì´ base64ë¡œ ì¸ì½”ë”©ëœ ë¬¸ìì—´ì´ ë‹´ê²¨ ìˆìŒ
        reader.onloadend = ()=>{
           diary.value.saveImage = reader.result
           console.log(diary.value.originalImage)
           axios.post('http://localhost:8080/diary-api/diary', diary.value, {
               headers: {
                   'Content-Type': 'application/json',
                    'access-token': sessionStorage.getItem('access-token')
               },
           }).then(() => {
               console.log("ë‹¤ì´ì–´ë¦¬ ì¶”ê°€ ì„±ê³µ")
               emit("closeDialog")
               router.go()
           }).catch(() => {
               console.log("ë‹¤ì´ì–´ë¦¬ ì¶”ê°€ ì‹¤íŒ¨")
           })
        }
    }else{
        axios.post('http://localhost:8080/diary-api/diary', diary.value, {
            headers: {
                'Content-Type': 'application/json',
                 'access-token': sessionStorage.getItem('access-token')
            },
        }).then(() => {
            emit("closeDialog")
            router.go()
        }).catch(() => {
            console.log("ë‹¤ì´ì–´ë¦¬ ì¶”ê°€ ì‹¤íŒ¨")
        })
    }
}
```
ğŸ’¡ Description <br>
ì´ë¯¸ì§€ íŒŒì¼ì„ Base64 ë¬¸ìì—´ë¡œ ì¸ì½”ë”©í•´ì„œ diary ê°ì²´ì— ë‹´ì•„ì„œ JSON ë°ì´í„° í˜•íƒœë¡œ ë°±ì—”ë“œ ë¶€ë¶„ìœ¼ë¡œ ì „ë‹¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë ‡ê²Œ ì „ë‹¬í•  ê²½ìš° ìŠ¤í”„ë§ì—ì„œ @RequestBody í˜•ì‹ìœ¼ë¡œ ë°›ì„ ìˆ˜ìˆìŠµë‹ˆë‹¤. ì‹¤ì œ íŒŒì¼ì„ ì—…ë¡œë“œ í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ë¬¸ìì—´ì„ ì €ì¥í•´ì„œ ë¶ˆëŸ¬ì˜¤ëŠ” í˜•ì‹ìœ¼ë¡œ í•œë‹¤ë©´ ì¸ì½”ë”©í•œ ë¬¸ìì—´ë§Œ ì €ì¥í•´ì„œ ê´€ë¦¬í•˜ë©´ ë©ë‹ˆë‹¤. í•˜ì§€ë§Œ ì‹¤ì œ íŒŒì¼ í˜•íƒœë¡œ ì—…ë¡œë“œí•˜ê³  ì‹¶ë‹¤ë©´ Base64 ë¬¸ìì—´ì„ ë””ì½”ë”©í•´ì„œ Byte[] ë°°ì—´ë¡œ ì „í™˜ í›„ Fileì„ ìƒì„±í•˜ëŠ” ë¡œì§ì„ ì¶”ê°€í•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.
<hr>
<br>

#### 3. diary ê°ì²´ë¥¼ formData í˜•íƒœë¡œ ì „ë‹¬

```js
const createDiary = function (event) {

    console.log(diary.value.content)
    
    if(diary.value.title == ""){
        alert("ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”")
        return
    }
    if(diary.value.content == ""){
        alert("ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”")
        return
    }

    diary.value.userId = userStore.loginUser.userId
    var formData = new FormData()
    if (image.value != null) {
        diary.value.originalImage = image.value.name
        formData.append('image', image.value)
        formData.append('diary', new Blob([JSON.stringify(diary.value)], { type: "application/json" }));
    } else {
        formData.append('diary', new Blob([JSON.stringify(diary.value)], { type: "application/json" }));
    }
    axios.post('http://localhost:8080/diary-api/diary', formData, {
        headers: {
            'Content-Type': 'multipart/form-data',
             'access-token': sessionStorage.getItem('access-token')

        },

    }).then(() => {
        console.log("ë‹¤ì´ì–´ë¦¬ ì¶”ê°€ ì„±ê³µ")
        emit("closeDialog")
        router.go()
    }).catch(() => {
        console.log("ë‹¤ì´ì–´ë¦¬ ì¶”ê°€ ì‹¤íŒ¨")
    })
}
const uploadName = ref('ì²¨ë¶€íŒŒì¼')

const imageUploaded = ref("../src/assets/Gymstagram2.png")
const image = ref(null)
const upload = function (e) {
    image.value = e.target.files[0]
    uploadName.value = image.value.name;
    imageUploaded.value = URL.createObjectURL(image.value)
}

```

ğŸ’¡ Description <br>
ì´ë¯¸ì§€ íŒŒì¼ì„ ë¬¸ìì—´ë¡œ ì „í™˜í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼, ì´ë²ˆì—ëŠ” JSON ê°ì²´ë¥¼ íŒŒì¼ í˜•íƒœë¡œ ì „í™˜í•´ì„œ formDataì— ë‹´ì€ í›„ì— ë°±ì—”ë“œë¡œ í•¨ê»˜ ë³´ë‚´ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. ì´ë•Œ Springì—ì„œëŠ” MultipartFile í˜•íƒœë¡œ, @RequestPartì™€ í•¨ê»˜ ë°ì´í„°ë¥¼ ì „ë‹¬ë°›ì•„ì„œ ì²˜ë¦¬í•˜ëŠ” ì‘ì—…ì„ í•´ì¤˜ì•¼í•©ë‹ˆë‹¤. 
<hr>
<br>
<br>

## ğŸ“Œ DB

### schema.sql
```sql
CREATE DATABASE IF NOT EXISTS ssafy_final;

USE ssafy_final;

DROP TABLE IF EXISTS `user`;
DROP TABLE IF EXISTS `diary`;
DROP TABLE IF EXISTS `comment`;
DROP TABLE IF EXISTS `avty`;
DROP TABLE IF EXISTS `likeDiary`;


CREATE TABLE IF NOT EXISTS `user`(
  `user_id` VARCHAR(20) CHARACTER SET utf8mb4 NOT NULL,
  `user_password` VARCHAR(20) CHARACTER SET utf8mb4 NOT NULL,
  `user_name` CHAR(10) CHARACTER SET utf8mb4 NOT NULL,
  `email` VARCHAR(45) CHARACTER SET utf8mb4,
  `nickname` VARCHAR(30) CHARACTER SET utf8mb4 NOT NULL,
  `register_date` DATE NOT NULL DEFAULT (current_date),
  `profile_image` VARCHAR(150),
  `activate` BOOLEAN NOT NULL DEFAULT true,
  `permission` INT NOT NULL DEFAULT 0,
  `avty_code` INT NOT NULL DEFAULT 0,
  PRIMARY KEY (`user_id`)
);

CREATE TABLE IF NOT EXISTS `diary`(
  `diary_id` INT AUTO_INCREMENT NOT NULL,
  `user_id` VARCHAR(20) CHARACTER SET utf8mb4 NOT NULL,
  `create_date` TIMESTAMP DEFAULT now(),
  `save_image` VARCHAR(150),
  `original_image` VARCHAR(50),
  `title` VARCHAR(45) CHARACTER SET utf8mb4 NOT NULL DEFAULT '',
  `content` LONGTEXT CHARACTER SET utf8mb4 NOT NULL,
  `view_count` INT(52) DEFAULT 0,
  `like_count` INT(52) DEFAULT 0,
  `range` INT(2) DEFAULT 0,
  `update_date` TIMESTAMP,
  CONSTRAINT `diary_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `user` (`user_id`) ON DELETE CASCADE,
  PRIMARY KEY (`diary_id`)
);

CREATE TABLE IF NOT EXISTS `comment`(
  `comment_id` INT(52) AUTO_INCREMENT NOT NULL,
  `diary_id` INT NOT NULL,
  `user_id` VARCHAR(45) CHARACTER SET utf8mb4 NOT NULL DEFAULT '',
  `content` VARCHAR(200) CHARACTER SET utf8mb4 NOT NULL DEFAULT '',
  `write_date` TIMESTAMP DEFAULT now(),
  `update_date` TIMESTAMP,
  `is_deleted` BOOLEAN NOT NULL DEFAULT false,
  `parent_comment` INT(52) NOT NULL DEFAULT 0,
  PRIMARY KEY (`comment_id`),
  CONSTRAINT `comment_ibfk_1` FOREIGN KEY (`diary_id`) REFERENCES `diary` (`diary_id`) ON DELETE CASCADE,
  CONSTRAINT `comment_ibfk_2` FOREIGN KEY (`user_id`) REFERENCES `user` (`user_id`) ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS `avty`(
  `avty_code` INT NOT NULL,
  `avty_name` CHAR(5) CHARACTER SET utf8mb4 NOT NULL,
   PRIMARY KEY (`avty_code`)
);

CREATE TABLE IF NOT EXISTS `likeDiary`(
  `user_id` VARCHAR(20) CHARACTER SET utf8mb4 NOT NULL,
  `diary_id` INT NOT NULL,
  PRIMARY KEY (`user_Id`, `diary_Id`),
  CONSTRAINT `like_ibfk_1` FOREIGN KEY (`user_Id`) REFERENCES `user` (`user_id`) ON DELETE CASCADE,
  CONSTRAINT `like_ibfk_2` FOREIGN KEY (`diary_Id`) REFERENCES `diary` (`diary_Id`) ON DELETE CASCADE
);
```

### data.sql

```sql
USE ssafy_final;

-- ë”ë¯¸ ë°ì´í„°

INSERT INTO `avty`VALUES
(0, 'ENJ'),
(1, 'ENP'),
(2, 'ESJ'),
(3, 'ESP'),
(4, 'INJ'),
(5, 'INP'),
(6, 'ISJ'),
(7, 'ISP'),
(8, 'í•´ë‹¹ì—†ìŒ');

INSERT INTO `user` (`user_id`, `user_password`, `user_name`, `nickname`, `avty_code`, `profile_image`) 
VALUES
('ssafy', '1q2w3e4r!', 'ì¡°í˜„ìˆ˜', 'ê°“í˜„ìˆ˜', 0, 'profile.png'),
('dhwlgP', '1q2w3e4r!', 'ì˜¤ì§€í˜œ', 'í—¤ì¼ë¦¬1', 0, 'profile.png'),
('rnjsdbrud', '1q2w3e4r!', 'ê¶Œìœ ê²½', 'Kìœ ê²½', 6, 'profile.png'),
('rlaskawns', '1q2w3e4r!', 'ê¹€ë‚¨ì¤€', 'ì˜¬ë¦¬ë²„ìŒ¤', 7, 'profile.png'),
('rlaqudgus', '1q2w3e4r!', 'ê¹€ë³‘í˜„', 'íŒ¬í‹°ë„ë‘‘', 7, 'profile.png'),
('rlatjsdud', '1q2w3e4r!', 'ê¹€ì„ ì˜', 'ì²«ì§¸ë”¸', 6, 'profile.png'),
('rladudtjq', '1q2w3e4r!', 'ê¹€ì˜ì„­', 'ë°˜ë ¤ê²¬', 5, 'profile.png'),
('rladPfla', '1q2w3e4r!', 'ê¹€ì˜ˆë¦¼', 'ì£¼ì¸', 7, 'profile.png'),
-- ì¤‘ëµ

INSERT INTO `diary` (`diary_id`,`user_id`,`create_date`,`save_image`,`original_image`,`title`,`content`,`view_count`,`like_count`,`range`,`update_date`) 
VALUES 
    (1,'ssafy','2023-11-01 09:01:22','01.jpg','01','ì˜¤ìš´ì™„ ì¸ì¦!','ì˜¤ëŠ˜ ìš´ë™ ë„ˆë¬´ í˜ë“¤ì—ˆëŠ”ë° ì—´ì‹¬íˆ í–ˆì–´ìš” !! ì•ìœ¼ë¡œ ë” ì—´ì‹¬íˆ ìš´ë™í•´ì„œ ëª¸ì§±ì´ ë ê±°ì•¼,,!',0,0,0,NULL),
    (2,'ssafy','2023-11-02 10:11:23','02.jpg','02','ì˜¤ëŠ˜ì˜ ê±°ìš¸ìƒ·','ìš´ë™í•˜ê³  ë‚˜ì„œ ê±°ìš¸ì—ì„œ ì‚¬ì§„ ì°ì–´ë‘ê¸°! í—¬ìŠ¤ì¥ì— ì‚¬ëŒì´ ë³„ë¡œ ì—†ì—ˆë‹¤ ~~',0,0,0,NULL),
    (3,'ssafy','2023-11-03 22:13:45','03.jpg','03','ì¡°ëª…ì°¾ì•„ ì‚¼ë§Œë¦¬','í™”ì¥ì‹¤ ì¡°ëª…ì—ì„œ ì°ìœ¼ë‹ˆê¹Œ ì–´ì œë³´ë‹¤ ê·¼ìœ¡ì´ ì˜ ë³´ì´ëŠ” ê²ƒ ê°™ê¸°ë„,, ì•„ë‹Œê°€?',0,0,0,NULL),
    (4,'ssafy','2023-11-04 09:03:45','04.jpg','04','ì¬ë°ŒëŠ” í—¬ìŠ¤','ì‚¬ì‹¤ì€ ë„˜ ì–´ë ¤ì›¡ ã…  í•˜ì§€ë§Œ í¬ê¸°ë€ ë°°ì¶” ì…€ ë•Œë‚˜ í•˜ëŠ” ì´ì•¼ê¸°ì•¼ í¬ê¸°í•˜ì§€ ì•Šê³  ëê¹Œì§€ ì•„ìì•„ì',0,0,0,NULL),
    (5,'ssafy','2023-11-05 09:10:22','05.jpg','05','í¬ë¡œìŠ¤í• ì²´í—˜','ìœ¤ì„±ë¹ˆ ì„ ìˆ˜ë³´ê³  í¬ë¡œìŠ¤í• ì²´í—˜í•˜ëŸ¬ ê°€ë´¤ëŠ”ë° ì§„ì§œ ì¬ë°Œì—ˆë‹¤ !! ë‹¤ì¹˜ì§€ ì•Šê²Œ ì¡°ì‹¬í•´ì•¼ì§€ ~~',0,0,0,NULL),
    (6,'ssafy','2023-11-09 10:01:22','06.jpg','06','ê°™ì´ ìš´ë™í•©ì‹œë‹¹!','í¬ë¡œìŠ¤í•ì€ ì‚¬ëŒë“¤ì´ë‘ ê°™ì´ í•  ìˆ˜ ìˆì–´ì„œ ì¢‹ì€ë“¯,,, ë‹¤ìŒì—” ì¹œêµ¬ ë°ë¦¬ê³  ê°€ì•¼ì§€',0,0,0,NULL),
    (7,'ssafy','2023-11-10 10:01:22','07.jpg','07','ì˜¤ëŠ˜ ìš´ë™ ë§›ìˆë‹¤ ~','ìš´ë™ ì—´ì‹¬íˆ í•©ì‹œë‹¤. ìš´ë™ì´ ìµœê³ ì•¼. ìš´ë™í•˜ë©´ ì˜¤ë˜ì‚´ê³  ê±´ê°•í•´ì§„ë‹¤ì‰',0,0,0,NULL);
-- ì¤‘ëµ


INSERT INTO `comment` (`comment_id`,`diary_id`,`user_id`,`content`,`write_date`,`update_date`,`is_deleted`,`parent_comment`) 
VALUES 
	(1,24,'dhwlgP','ì—­ì‹œ í˜„ìˆ˜ ë©‹ì ¸ìš” !!','2023-11-23 09:07:44',NULL,0,0),
    (2,95,'ssafy','ì—­ì‹œ ë‚´ ì¹œêµ¬ ìµœê³ ë‹¤ ğŸ’ªğŸ»','2023-11-23 09:20:20',NULL,0,0),
    (3,95,'shtpgml','ëŒ€íšŒ ì¤€ë¹„ ì‘ì›í•©ë‹ˆë‹¤ ~~~','2023-11-23 09:31:55',NULL,0,0),
    (4,24,'shtpgml','ì¡°í˜„ìˆ˜ ìµœê³  ã…‹ã……ã…‹','2023-11-23 09:32:14',NULL,0,0);

--ì¤‘ëµ

INSERT INTO `likediary` (`user_Id`,`diary_Id`) 
VALUES 
    ('rlatjsdud',23),
    ('shtpgml',23),
    ('dltmdgjs',24),
    ('shtpgml',24),
    ('dltmdgjs',64),
    ('dltmdgjs',69);
-- ì¤‘ëµ

```

<br>




## 	â—Commit Message Rule
### [ì»¤ë°‹ íƒ€ì…]: [ì‘ì—…ë‚´ìš©]

â• Feat : ê¸°ëŠ¥ (ìƒˆë¡œìš´ ê¸°ëŠ¥)

â•Fix : ë²„ê·¸ (ë²„ê·¸ ìˆ˜ì •)

â•  Refactor : ë¦¬íŒ©í† ë§

â•Design : cssë‚˜ ë””ìì¸ ë³€ê²½, ì´ë¯¸ì§€ ì¶”ê°€ ë“±

â•Style : ì½”ë“œ í¬ë§· ë³€ê²½, ì„¸ë¯¸ì½œë¡  ëˆ„ë½, ì½”ë“œ ìˆ˜ì •ì´ ì—†ëŠ” ê²½ìš°

â•Comment : í•„ìš”í•œ ì£¼ì„ ì¶”ê°€ í–ˆì„ ê²½ìš°

â•Docs : ë¬¸ì„œ (ë¬¸ì„œ ì¶”ê°€, ìˆ˜ì •, ì‚­ì œ ex. README.md, DailyScrum.md)

â•Chore : ê¸°íƒ€ ë³€ê²½ì‚¬í•­